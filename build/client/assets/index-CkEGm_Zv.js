import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as i,b as N}from"./components-Bk2QJ2_x.js";import{h as w,I as E,g as A,e as B,f as P}from"./lib-CX38AMOf.js";import{A as k,C}from"./ContentLayout-CGTLaQ00.js";import{B as L,a as D}from"./BusinessHeader-CdtMAgP4.js";import{u as R}from"./NotificationContext-CgVuEi2X.js";import{u as T}from"./AuthContext-9np3oh9B.js";import"./UserMenu-B8bPrQnJ.js";import"./index-DqqDyL6n.js";import"./index-BcVA-Rg0.js";import"./WhiteLogo-ChRPpjlG.js";import"./HomeNav-BnqawzPc.js";import"./SrchNavbar-CF057TGk.js";import"./HamburgerSecondary-CtRvEkVl.js";import"./index-DYBFzwkY.js";import"./CardTitle-e_7rmtxE.js";const U=({businessGuid:c,userGuid:j,facilityFeatures:r,selectedFacilityFeatures:p})=>{const[f,_]=i.useState(!1),o=R(),[h,g]=i.useState(null),[x,v]=i.useState(null),[u,l]=i.useState(null);i.useEffect(()=>{r&&p&&(g(r),v(p))},[r,p]),i.useEffect(()=>{if(h&&x){const t=h.map(n=>{const s=x.find(a=>a.feature_id===n.feature_id);return{...n,active:!!s,user_description:s?s.user_description:void 0}});l(t)}},[h,x]);const S=t=>{l(n=>n.map(s=>s.feature_id===t?{...s,active:!s.active,user_description:s.user_description?s.user_description:""}:s))},d=(t,n)=>{l(s=>s.map(a=>a.feature_id===t?{...a,user_description:n}:a))},y=async()=>{const s="https://garssete.gasimg.com"+"/api/listing/selected_facility_features";_(!0),o.notify(),await new Promise(a=>setTimeout(a,1e3));try{const a=u.filter(m=>m.active).map(m=>({feature_id:m.feature_id,user_description:m.user_description}));(await fetch(s,{method:"POST",headers:w,body:JSON.stringify({user_guid:j,business_guid:c,selected:a})})).ok?o.alertReload("","Saved successfully!"):o.alert("","Failed to save.")}catch{o.alert("","Something happened!")}finally{_(!1)}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Select Facility Features"}),r.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u==null?void 0:u.map(t=>e.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("input",{onChange:()=>S(t.feature_id),type:"checkbox",checked:t.active,className:"hidden"}),e.jsx("div",{className:`w-5 h-5 border-2 rounded ${t.active?"bg-green-500":"bg-white"}`})]}),e.jsxs("div",{className:" w-full",children:[e.jsx("p",{className:"font-medium ",children:t.name}),e.jsx("p",{className:"text-xs ",children:t.description}),e.jsx("div",{className:" w-full h-[100px] mt-1 rounded overflow-hidden",children:e.jsx("textarea",{onChange:n=>d(t.feature_id,n.target.value),className:`w-full h-full bg-gray-100
                                            border p-3 text-sm`,children:t.user_description})})]})]},t.feature_id))}),e.jsx("button",{onClick:y,className:"mt-5 px-4 py-2 bg-blue-600 text-white rounded",children:"Save Selected Features"})]})]})},ee=()=>{i.useEffect(()=>{E(localStorage)},[]);const[c,j]=i.useState(""),[r,p]=i.useState(""),[f,_]=i.useState(null),[o,h]=i.useState(null),[g,x]=i.useState(null),[v,u]=i.useState(!0),{business_guid:l,user_guid:S}=N(),[d,y]=i.useState(null);return T()?(i.useEffect(()=>{l&&S&&(async(s,a)=>{j(s),p(a);const F=await A();_(F);const b=await B(a,s);h(b);const m=await P(s||"");y(m)})(l,S)},[l,S]),i.useEffect(()=>{c&&r&&f&&o&&d&&(x({businessGuid:c,userGuid:r,facilityFeatures:f,selectedFacilityFeatures:o,businessProfile:d}),u(!1))},[c,r,f,o,d]),v?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(k,{children:e.jsxs(C,{businessGuid:c,data:g,businessProfile:d,title:"Facility Features",children:[e.jsx(L,{businessGuid:c,data:g,businessProfile:d}),c&&r&&e.jsx(D,{guid:c,userGuid:r}),g&&e.jsx(U,{userGuid:r,businessGuid:c,facilityFeatures:f,selectedFacilityFeatures:o})]})})):null};export{ee as default};
