import{j as t}from"./jsx-runtime-0DLF9kdB.js";import{r as s,a as H}from"./components-DN9bEK-g.js";import{A as V,C as q}from"./ContentLayout-_ebK7i0f.js";import{u as G}from"./AuthContext-Dgd_apKQ.js";import{z as o,u as K,s as M}from"./index-CORT_df8.js";import{o as Y,p as D,h as Q,i as X,q as ee,r as te}from"./lib-0UoF-2jt.js";import{I as d,B as se}from"./Input-BTQ3xtyH.js";import{S as C}from"./Select-BbHdXEnP.js";import{f as oe}from"./WhiteLogo-KvIGxFy1.js";import{T as re}from"./TextareaWithWordLimit-DKMTsAgx.js";import{u as ae}from"./NotificationContext-mjUCmhAx.js";import{C as ne}from"./CardTitle-Vm8bzRht.js";import"./UserMenu-B_d_27Ji.js";import"./index-CGVRBAuN.js";import"./index-BztbJNUF.js";import"./index-KkPTkV9P.js";import"./HomeNav--w42PZ0U.js";import"./SrchNavbar-Ckj6vZQ3.js";import"./HamburgerSecondary-4LoKiv2C.js";const ie=o.object({title:o.string().min(1,{message:"Enter a business name"}).min(3,{message:"Busines Name must not be less than 3 characters"}).max(100,{message:"Business name must not be more than 100 characters."}),category:o.string().min(1,{message:"Please select a business category."}),country_code:o.string({message:"Please select a country"}).min(1,{message:"Please enter a country code."}),state_code:o.any(),city_id:o.any(),zipcode:o.string().min(1,{message:"Zipcode must not be empty"}).max(7,{message:"Zipcode must not be more than 7 characters"}),short_description:o.string().refine(e=>e.trim().split(/\s+/).filter(Boolean).length>=30,{message:"You must write at least 30 words."}).refine(e=>e.trim().split(/\s+/).filter(Boolean).length<=50,{message:"You can only write up to 50 words."}),email_address:o.string({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"}),phone:o.string().min(1,{message:"Phone must not be empty"}).max(30,{message:"PHone must not be more than 30 characters"}),address_one:o.string({message:"Please enter an address"}).min(3,{message:"Address must not be less than 3 characters"}).max(100,{message:"Address must not be more than 100 characters"}),address_two:o.any(),established:o.string({message:"Please enter year established"}).min(4,{message:"Year must be at least 4 characters"})}).superRefine((e,c)=>{var h,u;((h=e==null?void 0:e.address_two)==null?void 0:h.length)!==0&&((u=e==null?void 0:e.address_two)==null?void 0:u.length)<3&&c.addIssue({code:o.ZodIssueCode.custom,path:["address_two"],message:"Enter a minimum of 3 characters"})}),ce=({data:e,user:c})=>{const[h,u]=s.useState(null),[b,f]=s.useState(!1),l=ae();H();const p=e.countries;let[P,_]=s.useState(e.states),[j,E]=s.useState(e.cities);const N=e.categories.data,[y,T]=s.useState(""),[B,A]=s.useState(""),[w,v]=s.useState(""),[S,I]=s.useState(""),W=async r=>{T(r),v(r);const g=await Y(r);_(g),J("")},J=async r=>{A(r),I(r);const g=await D(y,r);E(g)},a=r=>{let g=r.target.value,L=r.target.name;u(z=>({...z,[L]:g}))},Z=async r=>{f(!0),l.notify("Creating page..."),await new Promise(m=>setTimeout(m,1e3)),r.owner=c.guid;const L=X.BASE_URL+"/api/listing";try{const m=await fetch(L,{method:"POST",headers:Q,body:JSON.stringify(r)});if(m.ok){const R=async U=>{U||(window.location.href="/web/account/portfolio",await new Promise($=>setTimeout($,1e3))),l.cancel()};l.confirm("Page Created. Do you wish to create another page?",R)}else{var z=await m.json();throw new Error(`Error Code: ${m.status} - ${z.message}`)}}catch(m){l.alertCancel("Error!",m.message)}finally{f(!1)}},{register:n,handleSubmit:k,getValues:F,watch:O,setValue:x,setError:le,formState:{errors:i,isSubmitting:me}}=K({resolver:M(ie)});return s.useEffect(()=>{w&&(x("state_code",""),x("city_id",""))},[w]),s.useEffect(()=>{S&&x("city_id","")},[S]),t.jsx("form",{onSubmit:k(Z),children:t.jsxs("div",{className:`${oe} mt-0  rounded-lg pt-4
                             max-w-[500px] w-full mx-auto `,children:[t.jsx(d,{controlTitle:"Business Name",controlPlaceholder:"Enter business name",controlName:"title",register:n,changeHandler:a,error:i.title,width:80,controlInformation:"Business name is compulsory."}),t.jsx(d,{controlTitle:"Email Address",controlPlaceholder:"Enter email address",controlName:"email_address",register:n,changeHandler:a,error:i.email_address,controlInformation:"Email address is compulsory."}),t.jsx(C,{controlTitle:"Business Category",controlName:"category",controlPlaceholder:"Select business category",selectJson:N,register:n,changeHandler:a,error:i.category,controlInformation:"Select business category."}),t.jsx(d,{controlTitle:"Year established",controlPlaceholder:"Enter year established",controlName:"established",register:n,changeHandler:a,error:i.established,controlInformation:"Year registered is compulsory."}),t.jsx(C,{controlTitle:"Country",controlName:"country_code",controlPlaceholder:"Select country",selectJson:p,register:n,changeHandler:a,error:i.country_code,setCode:W}),t.jsx(C,{controlTitle:"State",controlName:"state_code",controlPlaceholder:"Select state",selectJson:P,register:n,changeHandler:a,error:i.state_code,setCode:J}),t.jsx(C,{controlTitle:"City",controlName:"city_id",controlPlaceholder:"Select city",selectJson:j,register:n,changeHandler:a,error:i.city_id}),t.jsx(d,{controlTitle:"Address 1",controlPlaceholder:"Enter address",controlName:"address_one",register:n,changeHandler:a,error:i.address_one,width:100}),t.jsx(d,{controlTitle:"Address 2",controlPlaceholder:"Enter address",controlName:"address_two",register:n,changeHandler:a,error:i.address_two,width:100}),t.jsx(d,{controlTitle:"Zipcode",controlPlaceholder:"Enter zipcode",controlName:"zipcode",register:n,changeHandler:a,error:i.zipcode}),t.jsx(d,{controlTitle:"Phone number",controlPlaceholder:"Enter phone number",controlName:"phone",register:n,changeHandler:a,error:i.phone}),t.jsx(re,{controlTitle:"Short Description",controlPlaceholder:"Short description",controlName:"short_description",register:n,changeHandler:a,error:i.short_description,setValue:x,getValues:F,watch:O}),t.jsx(se,{working:b})]})})},Ae=()=>{const e=G();if(!e)return null;const[c,h]=s.useState(null),[u,b]=s.useState(!0),[f,l]=s.useState(null),[p,P]=s.useState(null),[_,j]=s.useState(null),[E,N]=s.useState(null),[y,T]=s.useState(null);return s.useEffect(()=>{const B=async A=>{const w=await ee(),v=await Y(""),S=await D("",""),I=await te();P(w),j(v),N(S),T(I),h(A)};e!=null&&e.user&&B(e==null?void 0:e.user)},[e]),s.useEffect(()=>{c&&p&&y&&(l({user:c,countries:p,states:_,cities:E,categories:y}),b(!1))},[p,c]),u?t.jsx("div",{className:"flex justify-center items-center h-screen",children:t.jsx("div",{className:"text-lg",children:"Loading..."})}):t.jsx(V,{children:t.jsx(q,{title:"Create Business",children:f&&t.jsxs("div",{children:[t.jsx(ne,{baseUrl:"/web/account/profile",guid:"",children:"Go to Profile"}),t.jsx(ce,{data:f,user:c})]})})})};export{Ae as default};
