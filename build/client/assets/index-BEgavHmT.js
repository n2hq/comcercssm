import{j as s}from"./jsx-runtime-0DLF9kdB.js";import{u as k,s as C}from"./zod-g2XesUsp.js";import{r as i,b as T}from"./components-qdL6XBti.js";import{$ as B,I as E,a0 as A,N as O}from"./lib-gBiJsvjS.js";import{z as t}from"./index-C4bLmoCR.js";import{A as W,C as $}from"./ContentLayout-BujAhBLS.js";import{u as F}from"./NotificationContext-C5SCs4G2.js";import{f as L}from"./WhiteLogo-B3Ep-zpl.js";import{B as I,a as D}from"./BusinessHeader-WYgb6mWr.js";import{u as G}from"./AuthContext-VWDihtkd.js";import"./UserMenu-BSa44Rm0.js";import"./index-yejPY_Il.js";import"./HomeNav-CU038EwL.js";import"./SrchNavbar-Bv17_pyv.js";import"./json-DN8jjR4S.js";const V=/^(?!https?)(?!www\.?).*\..+$/g,z=t.object({username:t.any(),title:t.string().min(1,{message:"Enter a business name"}).min(3,{message:"Busines Name must not be less than 3 characters"}).max(100,{message:"Business name must not be more than 100 characters."}),country_code:t.string({message:"Please select a country"}).min(1,{message:"Please enter a country code."}),address_one:t.string({message:"Please enter an address"}).min(3,{message:"Address must not be less than 3 characters"}).max(100,{message:"Address must not be more than 100 characters"}),address_two:t.any(),state_code:t.any(),state_text:t.any(),country_text:t.any(),city:t.any(),established:t.string({message:"Please enter year established"}).min(4,{message:"Year must be at least 4 characters"}),call_code:t.any(),call_mobile:t.any(),zipcode:t.any(),intro:t.any(),category:t.string().min(2,{message:"Please select a business category"}),business_phrases:t.string({message:"Please enter business phrase"}).min(3,{message:"Business Phrases must not be less than 3 characters"}).max(1e3,{message:"Business Phrases must not be more than 100 characters"}),products:t.string({message:"Please enter products offered"}),services:t.union([t.string({message:"Please enter services offered"}).min(3,{message:"Please enter up to 3 characters"}),t.literal("")]),xsocial:t.any(),fbsocial:t.any(),linksocial:t.any(),website:t.union([t.string().regex(V).nullish(),t.literal("")]),email:t.string({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"})}).superRefine((o,c)=>{var l,n;((l=o==null?void 0:o.address_two)==null?void 0:l.length)!==0&&((n=o==null?void 0:o.address_two)==null?void 0:n.length)<3&&c.addIssue({code:t.ZodIssueCode.custom,path:["address_two"],message:"Enter a minimum of 3 characters"})}),P=["Closed","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30","24:00"],M=({data:o,onChange:c,options:l})=>{const[n,u]=i.useState(null),[m,g]=i.useState("no_hours"),[y,b]=i.useState(!1),h=F(),v=async e=>{const a=e;return{Monday:{start:a.monday_from,end:a.monday_to},Tuesday:{start:a.tuesday_from,end:a.tuesday_to},Wednesday:{start:a.wednesday_from,end:a.wednesday_to},Thursday:{start:a.thursday_from,end:a.thursday_to},Friday:{start:a.friday_from,end:a.friday_to},Saturday:{start:a.saturday_from,end:a.saturday_to},Sunday:{start:a.sunday_from,end:a.sunday_to}}};i.useEffect(()=>{(async()=>{const a=await v(o.operatingHours);u(a),c(a),g(o.operatingHours.open_status)})()},[o.operatingHours]);const p=(e,a,r)=>{if(!n)return;let f=r;if(n[e].end<=f&&f!=="Closed"){alert(`For ${e}, closing time must be later than opening time.`);return}u({...n,[e]:{...n[e],[a]:r}}),c(n)},_=(e,a,r)=>{if(!n)return;let f=n[e].start;if(r<=f&&f!=="Closed"){alert(`For ${e}, closing time must be later than opening time.`);return}u({...n,[e]:{...n[e],[a]:r}}),c(n)},d=async()=>{if(m===null)return h.alertCancel("","Please select working hours."),!1;b(!0),h.notify(),await new Promise(e=>setTimeout(e,1e3));try{const e=await B(m,n,o.businessGuid,o.userGuid);console.log(e),h.alert("",e.message),b(!1)}catch(e){h.alert("",e.message)}};return n?s.jsx("div",{children:s.jsx("div",{className:`${L}`,children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"w-full",children:l.map(e=>s.jsxs("label",{className:`flex items-center gap-3 p-3 rounded cursor-pointer ${m===e.value?" bg-blue-50":"border-gray-300"}`,children:[s.jsx("div",{className:"w-[20px]",children:s.jsx("input",{type:"radio",name:"openStatus",value:e.value,checked:m===e.value,onChange:()=>g(e.value),className:"accent-blue-600 w-[20px] h-[20px]"})}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-800",children:e.label}),s.jsx("span",{className:"text-[13px] text-gray-500",children:e.more})]})]},e.value))}),m==="selected_hours"&&Object.keys(n).map(e=>{var a;return s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{className:"w-24 font-semibold",children:e}),s.jsxs("select",{value:((a=n[e])==null?void 0:a.start)||"",onChange:r=>p(e,"start",r.target.value),className:"border p-2 rounded",children:[s.jsx("option",{value:"",children:"From..."}),P.map(r=>s.jsx("option",{value:r,children:r},r))]}),s.jsx("span",{children:"to"}),s.jsxs("select",{value:n[e].end||"",onChange:r=>_(e,"end",r.target.value),className:"border p-2 rounded",children:[s.jsx("option",{value:"",children:"To..."}),P.map(r=>s.jsx("option",{value:r,children:r},r))]})]},e)}),s.jsx("div",{children:s.jsx("button",{onClick:d,className:`mt-6 bg-blue-600 text-white px-6 py-2 
                            rounded hover:bg-blue-700 transition
                            shadow-md hover:shadow-lg hover:shadow-black/50`,children:y?"Saving...":"Save Business Hours"})})]})})}):s.jsx("p",{children:"Loading working hours..."})},me=()=>{i.useEffect(()=>{E(localStorage)},[]);const[o,c]=i.useState(!0),[l,n]=i.useState(""),[u,m]=i.useState(""),[g,y]=i.useState(),[b,h]=i.useState([]),v=[{value:"no_hours",label:"No Hours Available",more:"Visitors won't see business hours on this Page"},{value:"always_open",label:"Always Open",more:"e.g. Parks, beaches, roads"},{value:"permanently_closed",label:"Permanently Closed",more:"Permantently closed"},{value:"temporarily_closed",label:"Temporarily Closed",more:"Temporarily closed"},{value:"selected_hours",label:"Open During Selected Hours",more:"Open during selected hours"}],[p,_]=i.useState(null),[d,e]=i.useState(null),{business_guid:a,user_guid:r}=T();G(),i.useEffect(()=>{const w=async(x,S)=>{n(x),m(S);const N=await A(x,S);y(N);const H=await O(x||"");e(H)};try{a&&r&&w(a,r)}catch(x){console.log(x.message)}},[a,r]),i.useEffect(()=>{l&&u&&g&&d&&(_({businessGuid:l,userGuid:u,operatingHours:g,businessProfile:d}),c(!1))},[l,u,g,d]);const{register:f,handleSubmit:j,getValues:R,watch:U,setError:Y,formState:{errors:Z,isSubmitting:q}}=k({defaultValues:{},resolver:C(z)});return o?s.jsx("div",{className:"flex justify-center items-center h-screen",children:s.jsx("div",{className:"text-lg",children:"Loading..."})}):s.jsx(W,{children:s.jsxs($,{title:"Settings",businessGuid:l,data:p,businessProfile:d,children:[s.jsx(I,{businessGuid:l,data:p,businessProfile:d}),l&&u&&s.jsx(D,{guid:l,userGuid:u}),p&&s.jsx("div",{className:"mt-6",children:s.jsx(M,{data:p,onChange:h,options:v})})]})})};export{me as default};
