import{r as s,j as e}from"./components-BAvBE3fA.js";import{A as H,C as R}from"./ContentLayout-BULv8Qdt.js";import{a as z,b as D,u as V,d as O,e as U}from"./AuthContext-Tj_b5086.js";import{z as o,u as $,s as q}from"./index-CC8pXzgA.js";import{f as G,I as m,B as K}from"./Input-Dw9jNG5H.js";import{S as x}from"./Select-BsbTrLBE.js";import{T as M}from"./TextareaWithWordLimit-DAlAA7OU.js";import{u as Q}from"./NotificationContext-C8wtauTv.js";import"./MobileNav-C2nYESeh.js";import"./index-E-6-scJO.js";import"./UserMenu-CzhSTjVp.js";const X=o.object({title:o.string().min(1,{message:"Enter a business name"}).min(3,{message:"Busines Name must not be less than 3 characters"}).max(100,{message:"Business name must not be more than 100 characters."}),category:o.string().min(1,{message:"Please select a business category."}),country_code:o.string({message:"Please select a country"}).min(1,{message:"Please enter a country code."}),state_code:o.any(),city_id:o.any(),zipcode:o.string().min(1,{message:"Zipcode must not be empty"}).max(7,{message:"Zipcode must not be more than 7 characters"}),short_description:o.string({message:"Please enter business phrase"}).min(3,{message:"Short Description must not be less than 3 characters"}).max(1e3,{message:"Short Description must not be more than 1000 characters"}),email_address:o.string({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"}),phone:o.string().min(1,{message:"Phone must not be empty"}).max(30,{message:"PHone must not be more than 30 characters"}),address_one:o.string({message:"Please enter an address"}).min(3,{message:"Address must not be less than 3 characters"}).max(100,{message:"Address must not be more than 100 characters"}),address_two:o.any(),established:o.string({message:"Please enter year established"}).min(4,{message:"Year must be at least 4 characters"})}).superRefine((t,c)=>{var u,d;((u=t==null?void 0:t.address_two)==null?void 0:u.length)!==0&&((d=t==null?void 0:t.address_two)==null?void 0:d.length)<3&&c.addIssue({code:o.ZodIssueCode.custom,path:["address_two"],message:"Enter a minimum of 3 characters"})}),ee=({data:t,user:c})=>{const[u,d]=s.useState(null),[b,h]=s.useState(!1),C=Q(),g=t.countries;let[P,_]=s.useState(t.states),[j,w]=s.useState(t.cities);const N=t.categories.data,[p,E]=s.useState(""),[T,A]=s.useState(""),[f,v]=s.useState(""),[y,B]=s.useState(""),J=async r=>{E(r),v(r);const l=await z(r);_(l),I("")},I=async r=>{A(r),B(r);const l=await D(p,r);w(l)},a=r=>{let l=r.target.value,Y=r.target.name;d(k=>({...k,[Y]:l}))},L=async r=>(h(!0),C.notify("Creating page..."),await new Promise(l=>setTimeout(l,1e3)),r.owner=c.guid,alert(JSON.stringify(r)),!1),{register:n,handleSubmit:W,getValues:Z,watch:F,setValue:S,setError:te,formState:{errors:i,isSubmitting:se}}=$({resolver:q(X)});return s.useEffect(()=>{f&&(S("state_code",""),S("city_id",""))},[f]),s.useEffect(()=>{y&&S("city_id","")},[y]),e.jsx("form",{onSubmit:W(L),children:e.jsxs("div",{className:`${G} mt-0  rounded-lg pt-4
                             max-w-[500px] w-full mx-auto `,children:[e.jsx(m,{controlTitle:"Business Name",controlPlaceholder:"Enter business name",controlName:"title",register:n,changeHandler:a,error:i.title,width:80,controlInformation:"Business name is compulsory."}),e.jsx(m,{controlTitle:"Email Address",controlPlaceholder:"Enter email address",controlName:"email_address",register:n,changeHandler:a,error:i.email_address,controlInformation:"Email address is compulsory."}),e.jsx(x,{controlTitle:"Business Category",controlName:"category",controlPlaceholder:"Select business category",selectJson:N,register:n,changeHandler:a,error:i.category,controlInformation:"Select business category."}),e.jsx(m,{controlTitle:"Year established",controlPlaceholder:"Enter year established",controlName:"established",register:n,changeHandler:a,error:i.established,controlInformation:"Year registered is compulsory."}),e.jsx(x,{controlTitle:"Country",controlName:"country_code",controlPlaceholder:"Select country",selectJson:g,register:n,changeHandler:a,error:i.country_code,setCode:J}),e.jsx(x,{controlTitle:"State",controlName:"state_code",controlPlaceholder:"Select state",selectJson:P,register:n,changeHandler:a,error:i.state_code,setCode:I}),e.jsx(x,{controlTitle:"City",controlName:"city_id",controlPlaceholder:"Select city",selectJson:j,register:n,changeHandler:a,error:i.city_id}),e.jsx(m,{controlTitle:"Address 1",controlPlaceholder:"Enter address",controlName:"address_one",register:n,changeHandler:a,error:i.address_one,width:100}),e.jsx(m,{controlTitle:"Address 2",controlPlaceholder:"Enter address",controlName:"address_two",register:n,changeHandler:a,error:i.address_two,width:100}),e.jsx(m,{controlTitle:"Zipcode",controlPlaceholder:"Enter zipcode",controlName:"zipcode",register:n,changeHandler:a,error:i.zipcode}),e.jsx(m,{controlTitle:"Phone number",controlPlaceholder:"Enter phone number",controlName:"phone",register:n,changeHandler:a,error:i.phone}),e.jsx(M,{controlTitle:"Short Description",controlPlaceholder:"Short description",controlName:"short_description",register:n,changeHandler:a,error:i.short_description,setValue:S,getValues:Z,watch:F}),e.jsx(K,{working:b})]})})},he=()=>{const t=V(),[c,u]=s.useState(null),[d,b]=s.useState(!0),[h,C]=s.useState(null),[g,P]=s.useState(null),[_,j]=s.useState(null),[w,N]=s.useState(null),[p,E]=s.useState(null);return s.useEffect(()=>{const T=async A=>{const f=await O(),v=await z(""),y=await D("",""),B=await U();P(f),j(v),N(y),E(B),u(A)};t!=null&&t.user&&T(t==null?void 0:t.user)},[t]),s.useEffect(()=>{c&&g&&p&&(C({user:c,countries:g,states:_,cities:w,categories:p}),b(!1))},[g,c]),d?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(H,{children:e.jsx(R,{title:"Create Page",children:h&&e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-2 text-md",children:"Create a page"}),e.jsx(ee,{data:h,user:c})]})})})};export{he as default};
