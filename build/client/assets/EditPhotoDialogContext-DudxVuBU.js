import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as t}from"./components-DN9bEK-g.js";import{u as T}from"./NotificationContext-DQtpxZot.js";import{h as W}from"./index-BuMB8ucW.js";import{h as B}from"./lib-DkU1NRFm.js";const F=t.createContext(null);function Y(){return t.useContext(F)}function Z({children:m}){const[k,n]=t.useState(!1),[p,g]=t.useState(!1),[h,c]=t.useState(null),[f,C]=t.useState(null),[x,D]=t.useState(null),[b,y]=t.useState(!1),[w,j]=t.useState(null),r=T(),S=()=>{g(!1),c(null)},_=async()=>{n(!0);let N=document.getElementById("image_title");if(b){const d=new FormData;d.append("file",w),d.append("guid",f),d.append("bid",x),d.append("image_title",N.value),r.notify(),await new Promise(o=>setTimeout(o,2e3));const I="https://tynkpro.com"+"/business_gallery_pic_upload";try{const o=await fetch(I,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*"},body:d});if(o.ok)r.alertReload("","Image uploaded successfully!");else{let U=o.json().then(G=>{r.alert("",G.message)})}}catch{return}finally{n(!1)}}else alert("Please select an image to continue."),n(!1)};let P={dialog:p,setDialog:g,imgSrc:h,setImgSrc:c,handleCloseDialog:S,userGuid:f,setUserGuid:C,businessGuid:x,setBusinessGuid:D,isImgSelected:b,setIsImageSelected:y,selectedFile:w,setSelectedFile:j};return e.jsxs(F.Provider,{value:P,children:[p&&e.jsx("div",{className:`flex w-screen h-screen z-[3000] 
                fixed top-0 left-0 right-0 bottom-0 bg-black/30
                place-content-center place-items-center`,children:e.jsxs("div",{className:`relative w-[90%] h-[80%] bg-white 
                        rounded-[8px] overflow-hidden z-[3000]`,onClick:N=>{N.preventDefault()},children:[e.jsx("div",{className:"relative w-full h-[75%] bg-black",children:e.jsx("img",{src:h,alt:"",className:"object-scale-down w-full h-full"})}),e.jsx("div",{children:e.jsx("input",{id:"image_title",placeholder:"Enter picture description.",type:"text",className:"w-full bg-gray-100 px-3  h-[60px]"})}),e.jsxs("div",{className:"flex place-content-end px-3 gap-2",children:[e.jsx("button",{onMouseDown:()=>S(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:"Cancel"}),e.jsx("button",{onClick:()=>_(),className:`bg-blue-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:k?"Working...":"Submit"})]})]})}),m]})}const L=t.createContext(null);function $(){return t.useContext(L)}function ee({children:m}){const[k,n]=t.useState(!1),[p,g]=t.useState(!1),[h,c]=t.useState(null),[f,C]=t.useState(null),[x,D]=t.useState(null),[b,y]=t.useState(!1),[w,j]=t.useState(null),[r,S]=t.useState(null),[_,P]=t.useState(null),[N,d]=t.useState(null),E=t.useRef(null),u=T(),I=()=>{g(!1),c(null),n(!1)},o=()=>{var l;(l=E.current)==null||l.click()},U=l=>{var v;const s=(v=l.target.files)==null?void 0:v[0];if(s){const A=URL.createObjectURL(s);c(A),j(s),y(!0)}},G=async()=>{u.notify(),n(!0),await new Promise(i=>setTimeout(i,1e3));let l=document.getElementById("image_title");const s=new FormData;b&&s.append("file",w),s.append("guid",f),s.append("bid",x),s.append("image_title",l.value),s.append("image_guid",_);const R="https://tynkpro.com"+"/business_gallery_pic_update";try{const i=await fetch(R,{method:"POST",headers:B,body:s});if(i.ok)u.alert("Image Update","Image updated successfully!");else{let M=i.json().then(a=>{u.alert("",a.message)})}}catch{return}finally{n(!1)}};let z={dialog:p,setDialog:g,handleCloseDialog:I,imgSrc:h,setImgSrc:c,userGuid:f,setUserGuid:C,businessGuid:x,setBusinessGuid:D,isImgSelected:b,setIsImageSelected:y,selectedFile:w,setSelectedFile:j,imageTitle:r,setImageTitle:S,imageGuid:_,setImageGuid:P,deletePhoto:async(l,s,v)=>{const i="https://tynkpro.com"+"/delete_business_gallery_pic",M={guid:l,bid:s,image_guid:v};n(!0),await new Promise(a=>setTimeout(a,1e3));try{const a=await fetch(i,{method:"POST",headers:B,body:JSON.stringify(M)});if(a.ok)u.alertReload("","Image deleted successfully!");else{let J=a.json().then(O=>{u.alert(O.message)})}}catch(a){return alert(a.message)}finally{n(!1)}}};return e.jsxs(L.Provider,{value:z,children:[p&&e.jsx("div",{className:"fixed w-screen h-screen bg-black/30 z-[3000]",children:e.jsx("div",{className:`fixed w-screen h-screen z-[3000] 
                 top-0 left-0 right-0 bottom-0 bg-black/30
                place-content-center place-items-center`,children:e.jsx("div",{className:`relative w-[90%] h-[80%] bg-white 
                        rounded-[8px] overflow-hidden z-[3100] `,children:e.jsxs("div",{className:"w-full h-full overflow-y-auto",children:[e.jsxs("div",{className:"relative w-full h-[75%] bg-black",children:[e.jsx("img",{src:h,alt:"",className:"object-scale-down w-full h-full"}),e.jsx("input",{type:"file",accept:"image/*",ref:E,className:"hidden",onChange:U}),e.jsx("div",{className:`flex place-content-center place-items-center
                                                                     bg-black/10 w-full h-full absolute z-0 top-0 object-cover
                                                                     text-white/80 `,onMouseDown:o,children:e.jsx("div",{className:`w-[60px] h-[60px] flex flex-col
                                        place-content-center place-items-center bg-white/50
                                        hover:cursor-pointer hover:bg-white/50
                                        rounded-full transition duration-300 ease-in-out`,children:e.jsx(W,{className:" text-[30px]"})})})]}),e.jsxs("div",{className:"h-[25%]",children:[e.jsx("input",{onChange:l=>S(l.target.value),id:"image_title",value:r,placeholder:"Enter picture description.",type:"text",className:"w-full bg-gray-100 px-3  h-[60px]"}),e.jsxs("div",{className:"flex place-content-end px-3 gap-2",children:[e.jsx("button",{onMouseDown:()=>I(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:"Cancel"}),e.jsx("button",{onClick:()=>G(),className:`bg-blue-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:k?"Working...":"Submit"})]})]})]})})})}),m]})}export{Z as A,ee as E,$ as a,Y as u};
