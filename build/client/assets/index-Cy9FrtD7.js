import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as l,N as Z,c as H}from"./components-qdL6XBti.js";import{I as D}from"./index-Ddk6WeWA.js";import{u as ee}from"./SliderContext-BF_mL5BG.js";import{u as te}from"./AuthContext-392XTwOE.js";import{u as se,s as re}from"./zod-g2XesUsp.js";import{z as k}from"./index-C4bLmoCR.js";import{u as oe}from"./NotificationContext-CwI8K3Da.js";import{E as G,aA as le,a4 as P,aC as ce,w as ne}from"./lib-CAoDFbwa.js";import{T as ae}from"./TopAd-D4AdkyOi.js";import{S as de}from"./SearchLayout-IYi734cD.js";import{C as ie,F as me}from"./FooterSection-BXSHZwPU.js";import{V as xe}from"./VerticalHeight-CjKseacd.js";import"./json-26l_Net_.js";import"./SrchNavbar-CPvNIyRa.js";import"./UserMenu-Bq8B3kGt.js";import"./WhiteLogo-_cYqv2B8.js";const ue=l.createContext(null),pe=({children:s})=>{const[t,r]=l.useState(!1),[n,p]=l.useState(null),i=ee(),[a,u]=l.useState(null),x="https://pics.gasimg.com",h=()=>r(!1);let v={setShow:r,setGallery:p,setListing:u};const f=m=>{i.setDialog(!0),i.setSelectedSlide(m+1),i.setGallery(n)};return l.useEffect(()=>{const m=w=>{w.key==="Escape"&&h()};return t&&document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[t]),e.jsxs(ue.Provider,{value:v,children:[t&&e.jsxs("div",{onMouseDown:m=>r(!1),className:`flex w-screen h-screen bg-black/40 
                        z-[20000] fixed top-0 left-0 right-0 bottom-0
                        place-items-center place-content-center px-[15px]`,children:[e.jsx("div",{onMouseDown:m=>m.stopPropagation(),className:`min-w-[95%] w-[95%] sm:w-[95%] md:w-[80%] h-[80%] max-h-[80%] 
                            mx-auto bg-white rounded-lg shadow-lg shadow-black/50 
                            space-y-6 z-[3100] overflow-hidden`,children:e.jsxs("div",{className:"w-full h-full",children:[e.jsx("div",{className:"border-b py-3 px-3",children:e.jsxs("div",{className:`font-bold text-gray-700
                                    text-xl w-[80%]  truncate`,children:["Gallery for ",a&&(a==null?void 0:a.title)]})}),e.jsx("div",{className:` 
                                h-full overflow-y-auto pt-2 px-2 pb-2
                                bg-white `,children:e.jsx("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-2",children:n&&(n==null?void 0:n.map((m,w)=>e.jsx("div",{onClick:()=>f(w),className:`relative hover:cursor-pointer
                                                 bg-red-200 h-[80px] md:h-[100px] lg:h-[120px] rounded-md
                                                 overflow-hidden`,children:e.jsx("img",{className:"object-cover w-full h-full",src:x+m.image_url,alt:""})})))})})]})}),e.jsx("div",{onMouseDown:()=>h(),className:`w-[50px] h-[50px] z-[300] bg-white
                                flex place-content-center place-items-center
                                rounded-full absolute left-2 top-2 cursor-pointer
                                hover:bg-white/40 transition duration-1000 ease-in-out`,children:e.jsx(D,{className:"text-[30px]"})})]}),s]})},E=100,he=l.createContext(null),fe=k.object({fullname:k.any(),rating:k.any(),comment:k.any()});function ve({children:s}){var B,T,W;const[t,r]=l.useState(!1),[n,p]=l.useState(!1),[i,a]=l.useState(null),[u,x]=l.useState(void 0),[h,v]=l.useState(""),f=oe(),[m,w]=l.useState(5),c=te();if(!c)return null;let{user:b}=c;const[y,F]=l.useState(null),[z,_]=l.useState(!1),A=o=>o.trim()===""?0:o.trim().split(/\s+/).length,C=o=>{let d=o.target.value,j=o.target.name;F(N=>({...N,[j]:d}))},{register:R,handleSubmit:K,getValues:Se,setValue:L,watch:$,reset:V,setError:_e,formState:{errors:g,isSubmitting:ke}}=se({resolver:re(fe)}),O=o=>{const d=o.target.value,j=d.trim().split(/\s+/);if(j.length<=E)L("text",d),_(!1);else{_(!0);const N=j.slice(0,E).join(" ");L("text",N)}},q=async o=>{f.notify("Working..."),await new Promise(S=>setTimeout(S,1e3));const d=b.guid,j=i.gid;o.user_guid=d,o.business_guid=j;const X="https://edition.garssete.com"+"/api/rating";try{const S=await fetch(X,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),Y=await S.json();S.ok?f.alert("Success","Rating submitted successfully!"):f.alert("Error",Y.error)}catch(S){f.alert("",S.message)}};let I={show:t,setShow:r,setListing:a,reset:V,setRatingData:x,validateData:async(o,d)=>{if((o==null?void 0:o.length)===0){let j=(d==null?void 0:d.first_name)||"",N=(d==null?void 0:d.last_name)||"",M=j+" "+N;L("fullname",M)}}};const J=$("text")||"",Q=o=>{J.trim().split(/\s+/).length>=E&&o.key!=="Backspace"&&o.key!=="Delete"&&!o.ctrlKey?(o.preventDefault(),_(!0)):_(!1)};return l.useEffect(()=>{const o=d=>{d.key==="Escape"&&r(!1)};return t&&document.addEventListener("keydown",o),()=>{document.removeEventListener("keydown",o)}},[t]),e.jsxs(he.Provider,{value:I,children:[t&&e.jsx("div",{className:`flex w-screen h-screen bg-black/40 z-[3000] 
                fixed top-0 left-0 right-0 bottom-0 place-items-center place-content-center`,children:e.jsxs("div",{className:"w-[450px] h-fit mx-auto p-6 bg-white rounded-xl shadow-md space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Create/Edit Rating"}),e.jsxs("form",{onSubmit:K(q),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-semibold",children:"Full Name"}),e.jsx("input",{...R("fullname",{onChange:C}),type:"text",className:`w-full px-3 py-2 border rounded-md
                                        text-sm`,placeholder:"Enter Business GUID"}),((B=g.fullname)==null?void 0:B.message)&&e.jsx("div",{className:"text-red-500 mt-1 text-sm",children:g.fullname.message.toString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-semibold",children:"Stars"}),e.jsx("select",{...R("rating",{onChange:o=>{w(Number(o.target.value)),C(o)}}),className:`w-full px-3 py-2 border rounded-md
                                        text-sm`,children:[5,4,3,2,1].map(o=>e.jsxs("option",{value:o,children:[o," Star",o>1?"s":""]},o))}),((T=g.rating)==null?void 0:T.message)&&e.jsx("div",{className:"text-red-500 mt-1 text-sm",children:g.rating.message.toString()})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex place-content-between",children:[e.jsx("label",{className:"block mb-1 text-sm font-semibold",children:"Comment"}),e.jsxs("label",{className:" text-gray-600 text-sm",children:["Word Count: ",e.jsx("strong",{children:A(h)})]})]}),e.jsx("textarea",{...R("comment",{onChange:o=>{A(h)<=E?(v(o.target.value),O(o),C(o)):o.preventDefault()}}),onKeyDown:Q,className:`w-full px-3 py-2 border rounded-md 
                                        text-sm`,placeholder:"Write your review...",rows:4}),z&&e.jsx("div",{className:"text-red-500 mt-0 text-sm",children:"Maximum maximumWords words allowed."}),((W=g.comment)==null?void 0:W.message)&&e.jsx("div",{className:"text-red-500 mt-0 text-sm",children:g.comment.message.toString()})]}),e.jsxs("div",{className:"w-full grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:()=>r(!1),className:`w-full bg-red-200 rounded-md
                                        hover:bg-red-100 text-sm`,children:"Close"}),e.jsx("button",{type:"submit",disabled:n,className:`w-full bg-blue-600 text-white py-2 
                                        rounded-md hover:bg-blue-700 text-sm`,children:n?"Submitting...":"Submit Rating"})]})]})]})}),s]})}const je=({listing:s})=>e.jsxs("div",{children:[s!=null&&s.address_one?(s==null?void 0:s.address_one)+", ":"",s!=null&&s.state_code?(s==null?void 0:s.state_name)+", ":"",s!=null&&s.country_code?s==null?void 0:s.country_code:""]}),we=({listing:s,profileImageData:t,operatingHoursStatus:r,ratingsData:n})=>{const[p,i]=l.useState("");return l.useEffect(()=>{t&&i(G.IMG_BASE_URL+(t==null?void 0:t.image_url))},[t]),e.jsxs("div",{className:"flex gap-2 mt-2 w-full",children:[e.jsx("div",{className:"bg-white w-[95px] min-w-[95px] h-[95px] rounded-none relative overflow-hidden hidden md:block border border-gray-200  shadow-sm",children:e.jsx("img",{src:p,alt:"",className:" object-cover w-full h-full border-[1px]  border-gray-200"})}),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:`text-[19px] md:text-[24px]
                font-bold  leading-[1.2em] tracking-tight font-poppins`,children:s==null?void 0:s.title}),e.jsx("div",{children:e.jsx(je,{listing:s})}),e.jsx("div",{className:" leading-[1.3em] space-x-1 mt-1",children:r!==void 0&&e.jsxs("div",{className:" leading-[1.2em]",children:[r.openStatus==="selected_hours"?e.jsx("div",{children:r.todayHoursFormatted}):e.jsxs("div",{children:[r.openStatus==="always_open"&&e.jsx("div",{className:"bg-green-700 px-1 rounded-sm w-fit text-white pt-[2px] pb-[4px]",children:"Always Open"}),r.openStatus==="permanently_closed"&&e.jsx("div",{className:"bg-red-700 px-1 rounded-sm w-fit text-white pt-[2px] pb-[4px]",children:"Permantently Closed"}),r.openStatus==="temporarily_closed"&&e.jsx("div",{className:"bg-orange-400 px-1 rounded-sm w-fit text-white pt-[2px] pb-[4px]",children:"Temporarily Closed"})]}),e.jsx("div",{className:" w-full mx-auto mt-1.5",children:r==null?void 0:r.localTimeText})]})})]})]})};function U({rating:s}){return e.jsx("div",{className:"flex gap-x-[3px]",children:Array.from({length:5}).map((t,r)=>{const n=Math.max(0,Math.min(1,s-r))*100;return e.jsxs("div",{className:`relative w-[20px] h-[20px] ${s>0?"bg-blue-500":"bg-gray-200"} rounded 
                            overflow-hidden flex place-items-center
                            place-content-center`,children:[e.jsx("div",{className:"absolute inset-0 bg-green-400  z-[0]",style:{width:`${n}%`}}),e.jsx(le,{className:`relative z-[0] w-[14px] h-[14px] ${s>0?"text-black":"text-red-500"}`,fill:"currentColor"})]},r)})})}const be=({listing:s,images:t,ratingsData:r,videoGallery:n,products:p,profileImageData:i,reportTime:a})=>{const[u,x]=l.useState(),[h,v]=l.useState(void 0);return l.useEffect(()=>{s&&r&&x({totalReviews:0,category:s==null?void 0:s.category,rating:r.rating_average,ratingCount:r.rating_count})},[s,r]),l.useEffect(()=>{s&&a&&v(a)},[s,a]),e.jsx("div",{className:"mt-5",children:e.jsx("div",{className:"px-[15px] w-full",children:e.jsxs("div",{className:"max-w-[1100px] w-full mx-auto bg-white",children:[r&&e.jsxs("div",{className:"mt-4 flex gap-2 place-items-center",children:[e.jsx(U,{rating:Number(r==null?void 0:r.rating_average)}),e.jsxs("div",{className:`flex place-items-center place-content-center
                                    gap-1 text-black/60 text-[14px]`,children:[e.jsx("div",{children:P(Number(r==null?void 0:r.rating_average))}),e.jsxs("div",{children:["(",e.jsxs("span",{className:"underline",children:[P(r==null?void 0:r.rating_count)," reviews"]}),")"]})]})]}),s&&i&&e.jsx(we,{listing:s,profileImageData:i,operatingHoursStatus:h,ratingsData:r})]})})})},ye=({title:s,subtitle:t})=>e.jsxs("div",{className:"mb-6 border-b pb-4 -space-y-1",children:[e.jsx("div",{className:`text-[19px] font-bold
                `,children:s}),e.jsx("div",{className:"text-sm ",children:t})]}),ge=({title:s,subtitle:t,category:r,limit:n})=>{const[p,i]=l.useState(""),[a,u]=l.useState(""),[x,h]=l.useState([]),[v,f]=l.useState(""),m="https://pics.gasimg.com";l.useEffect(()=>{s&&t&&(i(s),u(t))},[s,t]);let w=async(c,b)=>{if(b&&c){let y=await ce(c,b);h(y)}};return l.useEffect(()=>{n&&r&&w(r,n)},[n,r]),e.jsx("div",{className:"px-[15px]",children:e.jsx("div",{className:"max-w-[1100px] mx-auto w-full",children:e.jsxs("div",{className:"mt-10 border-t pt-5",children:[e.jsx("div",{className:" mb-[20px] ",children:e.jsx(ye,{title:p,subtitle:a})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-x-3 gap-y-4",children:Array.isArray(x)&&(x==null?void 0:x.map((c,b)=>{let y="";return c!=null&&c.username?y=c==null?void 0:c.username:y=c==null?void 0:c.gid,e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(Z,{to:`/${y}`,children:e.jsx("div",{className:"relative h-[120px] rounded-lg md:h-[180px] overflow-hidden",children:e.jsx("img",{className:`object-cover w-full h-full
                                                    text-sm`,src:c!=null&&c.image_url?m+(c==null?void 0:c.image_url):"images/placeholder.gif",alt:c.title})})})}),e.jsx("div",{className:`mt-1 text-[15px] tracking-tight 
                                     truncate`,children:c.title}),e.jsx("div",{className:"mt-1",children:e.jsx(U,{rating:c.avg_rating})}),e.jsx("div",{className:`text-[11px] mt-[5px] tracking-tight line-clamp-3
                                    leading-[1.2em]`,children:c.short_description})]},b)}))})]})})})},Ne=()=>e.jsx("div",{className:"flex place-content-center place-items-center w-full min-h-[700px] text-[13px] flex-col space-y-4",children:e.jsxs("div",{className:`flex place-content-center place-items-center gap-3
                h-[40px]`,children:[e.jsx("div",{className:`text-2xl font-bold text-red-600 h-full
                    flex place-items-center`,children:"404"}),e.jsx("div",{className:"h-full w-[2px] border-r"}),e.jsxs("div",{className:`text-black text-[14px]
                    h-full flex place-items-center space-x-2`,children:[e.jsx("span",{children:"Resource not found."}),e.jsx("button",{onClick:()=>{window.history.back()},className:"underline",children:"Go back"})]})]})}),qe=({data:s})=>{try{const t=s==null?void 0:s.listing,r=s==null?void 0:s.profileImageData;let n="";(r==null?void 0:r.image_url)===""||(r==null?void 0:r.image_url)===null||(r==null?void 0:r.image_url)===void 0?n=`${G.BASE_URL}/images/abstract_placeholder.jpg`:n=G.IMG_BASE_URL+(r==null?void 0:r.image_url);const p=r==null?void 0:r.mimetype,a=(u=>{var v,f;if(u==null||u==="")return null;const x=u.replace(/&/g,",");return(f=(v=x==null?void 0:x.split(","))==null?void 0:v.map(m=>m.trim()))==null?void 0:f.filter(m=>m.length>0)})((t==null?void 0:t.business_phrases)||null);return[{title:(t==null?void 0:t.title)||"Garssete Inc."},{name:"description",content:t==null?void 0:t.short_description},{name:"keywords",content:a},{property:"fb:app_id",content:"1325393508603168"},{property:"og:url",content:(t==null?void 0:t.website)||"https://garssete.com"},{property:"og:type",content:"website"},{property:"og:title",content:(t==null?void 0:t.title)||"Garssete.com"},{property:"og:description",content:t==null?void 0:t.short_description},{property:"og:image",content:n},{property:"og:image:secure_url",content:n},{property:"og:image:type",content:p},{property:"og:image:width",content:"200"},{property:"og:image:alt",content:(t==null?void 0:t.title)||"Garssete"},{name:"twitter:creator",content:"garssete"},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:title",content:(t==null?void 0:t.title)||"Garssete Directory Listing"},{name:"twitter:description",content:t==null?void 0:t.short_description}]}catch(t){ne(t)}return[]},Ie=()=>{const s=H(),t=s.listing,r=s.gallery,n=s.ratingsData,p=s.videoGallery,i=s.products,a=s.profileImageData,u=s.reportTime;return l.useEffect(()=>{},[t]),e.jsx(ve,{children:e.jsx(pe,{children:e.jsxs(de,{children:[e.jsx(ae,{}),t.gid!==null&&t.gid!==void 0&&r&&n&&p&&i&&a&&u&&e.jsx(be,{listing:t,images:r,ratingsData:n,videoGallery:p,products:i,profileImageData:a,reportTime:u}),(t==null?void 0:t.category)!==void 0?e.jsx(ge,{category:t==null?void 0:t.category,limit:6,title:`Related: ${t==null?void 0:t.category}`,subtitle:"Related based on the same category."}):e.jsx(Ne,{}),e.jsx(xe,{}),e.jsx(ie,{}),e.jsx(me,{})]})})})};export{Ie as default,qe as meta};
