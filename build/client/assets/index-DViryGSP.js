import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r}from"./components-CCwaTRgT.js";import{A as L}from"./AccountLayout-zLF_nnCh.js";import{u as T}from"./AuthContext-C7k3lHjW.js";import{m as I,x as B,I as O,j as R}from"./lib-d5lyMBXU.js";import{u as k,s as C}from"./zod-PtQGc9r6.js";import{I as F,B as V}from"./Input-Be1j46Iq.js";import{z as E}from"./index-C4bLmoCR.js";import{f as W,g as _}from"./WhiteLogo-hx6VZQD6.js";import{u as $}from"./NotificationContext-BVMvs2cM.js";import{u as z}from"./OperationContext-BhT9SWU1.js";import{P as H}from"./ProfileContentLayout-DtcDG0oh.js";import"./UserMenu-BJva0xcL.js";import"./index-oI16Z90E.js";import"./HomeNav-CVNWGNT6.js";import"./SrchNavbar-BmbhUp-t.js";import"./HamburgerSecondary-BkHc2D4C.js";import"./BusinessMenu-lxtqnmPk.js";const J=E.object({email:E.string({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"})}),Y=({loaderData:s,user:t})=>{var P,w,j;const[a,g]=r.useState(null),[i,f]=r.useState(!1);$();const{showOperation:d,showError:p,completeOperation:n,showSuccess:c}=z(),v=o=>{let m=o.target.value,y=o.target.name;g(h=>({...h,[y]:m}))},A=async o=>{var b;f(!0);let m="";s.userProfile.active?m="Deactivating...":m="Activating...",d("processing",m),await new Promise(l=>setTimeout(l,1e3));const h="/api/user/activate_deactivate/"+s.userProfile.user_guid,D=B.BASE_URL+h;o.active=!((b=s.userProfile)!=null&&b.active);try{const l=await fetch(D,{method:"PUT",headers:I,body:JSON.stringify(o)});if(l.ok){let S=o.active?"Activated.":"Deactivated.";c("Success",S),await new Promise(u=>setTimeout(u,1e3)),d("processing","Refreshing..."),await new Promise(u=>setTimeout(u,4e3)),window.location.reload(),n()}else{let S=l.json().then(u=>{p("Error",u.message),n()})}}catch(l){console.log(l.message),p("Error","Process not completed.")}finally{f(!1)}},{register:N,handleSubmit:U,getValues:q,setValue:G,watch:K,setError:M,formState:{errors:x,isSubmitting:Q}}=k({defaultValues:s.userProfile,resolver:C(J)});return e.jsx("form",{onSubmit:U(A),children:e.jsx("div",{className:`${W} mt-0  
                        rounded-lg pt-4 max-w-[500px] w-full mx-auto`,children:e.jsxs("div",{className:_,children:[e.jsx("div",{className:" text-xl text-gray-700 font-semibold border-b pb-1",children:(P=s.userProfile)!=null&&P.active?"Deactivate User":"Activate User"}),e.jsxs("div",{className:" pt-3 pb-4 text-[13px] leading-5",children:[e.jsx("b",{children:(w=s.userProfile)==null?void 0:w.email})," is your current email. It will be used for password resets or changes."]}),e.jsx("div",{className:"mt-[10px]"}),e.jsx(F,{controlTitle:"Your Email Address",controlPlaceholder:"Retype new password",controlName:"email",controlType:"text",disabled:!0,register:N,changeHandler:v,error:x==null?void 0:x.email}),e.jsx(V,{working:i,value:`${(j=s.userProfile)!=null&&j.active?"Deactivate":"Activate"} Profile`})]})})})},ve=()=>{r.useEffect(()=>{O(localStorage)},[]);const s=T();if(!s)return null;const{user:t}=s,[a,g]=r.useState(null),[i,f]=r.useState(null),[d,p]=r.useState(!0);return r.useEffect(()=>{async function n(c){const v=await R(c||"");g(v)}try{t!=null&&t.guid&&n(t==null?void 0:t.guid)}catch(c){console.log(c.message)}},[t==null?void 0:t.guid]),r.useEffect(()=>{a&&f({userProfile:a})},[a]),r.useEffect(()=>{i&&p(!1)},[i]),d?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(L,{children:e.jsxs(H,{title:a.active?"Deactivate Profile":"Activate Profile",children:[a===null?"Loading...":"",i&&e.jsx(Y,{loaderData:i,user:t})]})})};export{ve as default};
