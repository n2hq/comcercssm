import{r as a,j as t}from"./components-UScJPEQZ.js";import{A as w,C as v}from"./ContentLayout-CO-DDPSz.js";import{h as N,c as C,u as P,g as A}from"./AuthContext-DP2umk9J.js";import{z as h,u as R,s as U}from"./index-DFVatVxl.js";import{f as q,i as _,I as k,B}from"./Input-CYtmRVes.js";import{u as F}from"./NotificationContext-LbrYtE65.js";import"./MobileNav-BzWLh9uv.js";import"./index-DOwvlINV.js";import"./UserMenu-VTcL3ELE.js";const I=h.object({email:h.string({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"})}),L=({loaderData:e,user:s})=>{var p,g;const[f,l]=a.useState(null),[c,r]=a.useState(!1),i=F(),d=n=>{let x=n.target.value,u=n.target.name;l(m=>({...m,[u]:x}))},b=async n=>{var m;r(!0),i.notify("","Updating email..."),await new Promise(o=>setTimeout(o,1e3));const u=C.BASE_URL+"/api/user/change_email_request";n.guid=(m=e.userProfile)==null?void 0:m.user_guid;try{const o=await fetch(u,{method:"POST",headers:N,body:JSON.stringify(n)});if(o.ok)i.alertCancel("Email Change Request","Email Change Request Successfully Sent!");else{let D=o.json().then(S=>{i.alertCancel("Error",S.error)})}}catch{return}finally{r(!1)}},{register:j,handleSubmit:E,getValues:T,setValue:V,watch:W,setError:O,formState:{errors:y,isSubmitting:z}}=R({defaultValues:e.listing,resolver:U(I)});return t.jsx("form",{onSubmit:E(b),children:t.jsx("div",{className:`${q} mt-0  rounded-lg pt-4
                             max-w-[500px] w-full mx-auto`,children:t.jsxs("div",{className:_,children:[t.jsx("div",{className:" text-xl text-gray-700 font-semibold border-b pb-1",children:"Current email"}),t.jsxs("div",{className:" pt-3 pb-4 text-[13px] leading-5",children:[t.jsxs("span",{className:" font-semibold",children:["[",(p=e.userProfile)==null?void 0:p.email,"]"]})," will be used for account-related notifications and can be used for password resets."]}),t.jsxs("div",{className:"border-[1px] rounded-[8px] px-3 py-3 bg-gray-100",children:[(g=e.userProfile)==null?void 0:g.email," Â "]}),t.jsx("div",{className:"mt-[20px]"}),t.jsx(k,{controlTitle:"Update Email",controlPlaceholder:"Enter new email address",controlName:"email",register:j,changeHandler:d,error:y.email,width:100,controlInformation:"Enter a new email address."}),t.jsx(B,{working:c})]})})})},Z=()=>{const{user:e}=P(),[s,f]=a.useState(null),[l,c]=a.useState(null);return a.useEffect(()=>{async function r(i){const d=await A(i||"");f(d)}e!=null&&e.guid&&r(e==null?void 0:e.guid)},[e==null?void 0:e.guid]),a.useEffect(()=>{s&&c({userProfile:s})},[s]),t.jsx(w,{children:t.jsxs(v,{title:"Email Address",children:[t.jsx("div",{className:"font-semibold mb-2 text-md",children:s==null?void 0:s.email}),l&&t.jsx(L,{loaderData:l,user:e})]})})};export{Z as default};
