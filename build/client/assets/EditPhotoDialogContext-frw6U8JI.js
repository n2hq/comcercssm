import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as t}from"./components-kAvIA9Ge.js";import{u as B}from"./NotificationContext-ww5sY1hZ.js";import{a as z}from"./index-D1npojxj.js";import{h as W}from"./index-WKNWlyJ5.js";const T=t.createContext(null);function Y(){const o=t.useContext(T);if(!o)throw new Error("useAddPhotoDialogContext must be used within an AuthProvider");return o}function Z({children:o}){const[I,n]=t.useState(!1),[h,g]=t.useState(!1),[p,r]=t.useState(null),[f,P]=t.useState(null),[x,D]=t.useState(null),[w,y]=t.useState(!1),[b,j]=t.useState(null),d=B(),v=()=>{g(!1),r(null)},_=async()=>{n(!0);let C=document.getElementById("image_title");if(w){const u=new FormData;u.append("file",b),u.append("guid",f),u.append("bid",x),u.append("image_title",C.value),d.notify(),await new Promise(i=>setTimeout(i,2e3));const N="https://oxbyt.com"+"/business_gallery_pic_upload";try{const i=await fetch(N,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*"},body:u});if(i.ok)d.alertReload("","Image uploaded successfully!");else{let U=i.json().then(A=>{d.alert("",A.message)})}}catch{return}finally{n(!1)}}else alert("Please select an image to continue."),n(!1)};let E={dialog:h,setDialog:g,imgSrc:p,setImgSrc:r,handleCloseDialog:v,userGuid:f,setUserGuid:P,businessGuid:x,setBusinessGuid:D,isImgSelected:w,setIsImageSelected:y,selectedFile:b,setSelectedFile:j};return e.jsxs(T.Provider,{value:E,children:[h&&e.jsx("div",{className:`flex w-screen h-screen z-[3000] 
                fixed top-0 left-0 right-0 bottom-0 bg-black/30
                place-content-center place-items-center`,children:e.jsxs("div",{className:`relative w-[90%] h-[80%] bg-white 
                        rounded-[8px] overflow-hidden z-[3000]`,onClick:C=>{C.preventDefault()},children:[e.jsx("div",{className:"relative w-full h-[75%] bg-black",children:e.jsx("img",{src:p,alt:"",className:"object-scale-down w-full h-full"})}),e.jsx("div",{children:e.jsx("input",{id:"image_title",placeholder:"Enter picture description.",type:"text",className:"w-full bg-gray-100 px-3  h-[60px]"})}),e.jsxs("div",{className:"flex place-content-end px-3 gap-2",children:[e.jsx("button",{onMouseDown:()=>v(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:"Cancel"}),e.jsx("button",{onClick:()=>_(),className:`bg-blue-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:I?"Working...":"Submit"})]})]})}),o]})}const F=t.createContext(null);function $(){const o=t.useContext(F);if(!o)throw new Error("useEditPhotoDialogContext must be used within an EditPhotoDialogProvider");return o}function ee({children:o}){const[I,n]=t.useState(!1),[h,g]=t.useState(!1),[p,r]=t.useState(null),[f,P]=t.useState(null),[x,D]=t.useState(null),[w,y]=t.useState(!1),[b,j]=t.useState(null),[d,v]=t.useState(null),[_,E]=t.useState(null),[C,u]=t.useState(null),k=t.useRef(null),m=B(),N=()=>{g(!1),r(null),n(!1)},i=()=>{var l;(l=k.current)==null||l.click()},U=l=>{var S;const s=(S=l.target.files)==null?void 0:S[0];if(s){const G=URL.createObjectURL(s);r(G),j(s),y(!0)}},A=async()=>{m.notify(),n(!0),await new Promise(c=>setTimeout(c,1e3));let l=document.getElementById("image_title");const s=new FormData;w&&s.append("file",b),s.append("guid",f),s.append("bid",x),s.append("image_title",l.value),s.append("image_guid",_);const R="https://oxbyt.com"+"/business_gallery_pic_update";try{const c=await fetch(R,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*"},body:s});if(c.ok)m.alert("Image Update","Image updated successfully!");else{let M=c.json().then(a=>{m.alert("",a.message)})}}catch{return}finally{n(!1)}};let L={dialog:h,setDialog:g,handleCloseDialog:N,imgSrc:p,setImgSrc:r,userGuid:f,setUserGuid:P,businessGuid:x,setBusinessGuid:D,isImgSelected:w,setIsImageSelected:y,selectedFile:b,setSelectedFile:j,imageTitle:d,setImageTitle:v,imageGuid:_,setImageGuid:E,deletePhoto:async(l,s,S)=>{const c="https://oxbyt.com"+"/delete_business_gallery_pic",M={guid:l,bid:s,image_guid:S};n(!0),await new Promise(a=>setTimeout(a,1e3));try{const a=await fetch(c,{method:"POST",headers:W,body:JSON.stringify(M)});if(a.ok)m.alertReload("","Image deleted successfully!");else{let J=a.json().then(O=>{m.alert(O.message)})}}catch(a){return alert(a.message)}finally{n(!1)}}};return e.jsxs(F.Provider,{value:L,children:[h&&e.jsx("div",{className:"fixed w-screen h-screen bg-black/30 z-[3000]",children:e.jsx("div",{className:`fixed w-screen h-screen z-[3000] 
                 top-0 left-0 right-0 bottom-0 bg-black/30
                place-content-center place-items-center`,children:e.jsx("div",{className:`relative w-[90%] h-[80%] bg-white 
                        rounded-[8px] overflow-hidden z-[3100] `,children:e.jsxs("div",{className:"w-full h-full overflow-y-auto",children:[e.jsxs("div",{className:"relative w-full h-[75%] bg-black",children:[e.jsx("img",{src:p,alt:"",className:"object-scale-down w-full h-full"}),e.jsx("input",{type:"file",accept:"image/*",ref:k,className:"hidden",onChange:U}),e.jsx("div",{className:`flex place-content-center place-items-center
                                                                     bg-black/10 w-full h-full absolute z-0 top-0 object-cover
                                                                     text-white/80 `,onMouseDown:i,children:e.jsx("div",{className:`w-[60px] h-[60px] flex flex-col
                                        place-content-center place-items-center bg-white/50
                                        hover:cursor-pointer hover:bg-white/50
                                        rounded-full transition duration-300 ease-in-out`,children:e.jsx(z,{className:" text-[30px]"})})})]}),e.jsxs("div",{className:"h-[25%]",children:[e.jsx("input",{onChange:l=>v(l.target.value),id:"image_title",value:d,placeholder:"Enter picture description.",type:"text",className:"w-full bg-gray-100 px-3  h-[60px]"}),e.jsxs("div",{className:"flex place-content-end px-3 gap-2",children:[e.jsx("button",{onMouseDown:()=>N(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:"Cancel"}),e.jsx("button",{onClick:()=>A(),className:`bg-blue-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:I?"Working...":"Submit"})]})]})]})})})}),o]})}export{Z as A,ee as E,$ as a,Y as u};
