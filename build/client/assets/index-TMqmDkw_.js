import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as i,b as N}from"./components-DN9bEK-g.js";import{h as E,I as k,j as C,k as P,e as A}from"./lib-mi7X90Kj.js";import{A as B,C as L}from"./ContentLayout-Dmj5mJqn.js";import{B as M}from"./BusinessMenu-BlqJeUcB.js";import{u as D}from"./NotificationContext-DIsBguWG.js";import{C as F}from"./CardTitle-Vm8bzRht.js";import"./UserMenu-DuiTAoTF.js";import"./index-_V50BjgN.js";import"./index-BqiilUUJ.js";import"./AuthContext-Bw1iO2U4.js";import"./WhiteLogo-Q21Q_qJt.js";import"./HomeNav-BEbpq4eX.js";import"./SrchNavbar-tp8rR0qb.js";import"./HamburgerSecondary-D1k80ChW.js";const R=({businessGuid:r,userGuid:b,allSocialMedia:n,allSelectedSocialMedia:p})=>{const[f,_]=i.useState(!1),c=D(),[h,l]=i.useState(null),[g,j]=i.useState(null),[u,d]=i.useState(null);i.useEffect(()=>{n&&p&&(l(n),j(p))},[n,p]),i.useEffect(()=>{if(h&&g){const s=h.map(o=>{const t=g.find(a=>a.media_id===o.media_id);return{...o,active:!!t,user_description:t?t.user_description:void 0}});d(s)}},[h,g]);const x=s=>{d(o=>o.map(t=>t.media_id===s?{...t,active:!t.active,user_description:t.user_description?t.user_description:""}:t))},S=(s,o)=>{d(t=>t.map(a=>a.media_id===s?{...a,user_description:o}:a))},v=async()=>{const t="https://edition.garssete.com"+"/api/listing/selected_social_media";_(!0),c.notify(),await new Promise(a=>setTimeout(a,1e3));try{const a=u.filter(m=>m.active).map(m=>({media_id:m.media_id,user_description:m.user_description}));(await fetch(t,{method:"POST",headers:E,body:JSON.stringify({user_guid:b,business_guid:r,selected:a})})).ok?c.alertReload("","Saved successfully!"):c.alert("","Failed to save.")}catch{c.alert("","Something happened!")}finally{_(!1)}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Select Social Media"}),n.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u==null?void 0:u.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("input",{onChange:()=>x(s.media_id),type:"checkbox",checked:s.active,className:"hidden"}),e.jsx("div",{className:`w-5 h-5 border-[1px] border-black  rounded-none 
                                            ${s.active?"bg-blue-400":"bg-white"}`})]}),e.jsxs("div",{className:" w-full",children:[e.jsx("p",{className:"font-medium ",children:s.name}),e.jsx("div",{className:" w-full h-[50px] mt-1 rounded overflow-hidden",children:e.jsx("textarea",{onChange:o=>S(s.media_id,o.target.value),className:`w-full h-full bg-gray-100
                                            border p-3 text-sm`,children:s.user_description})})]})]},s.media_id))}),e.jsx("button",{onClick:v,className:"mt-5 px-4 py-2 bg-blue-600 text-white rounded",children:"Save Selected Social Media"})]})]})},Y=()=>{var s;i.useEffect(()=>{k(localStorage)},[]);const[r,b]=i.useState(""),[n,p]=i.useState(""),[f,_]=i.useState(null),[c,h]=i.useState(null),[l,g]=i.useState(null),[j,u]=i.useState(!0),{business_guid:d,user_guid:x}=N(),[S,v]=i.useState(null);return i.useEffect(()=>{d&&x&&(async(t,a)=>{b(t),p(a);const y=await C();_(y);const w=await P(a,t);h(w);const m=await A(t||"");v(m)})(d,x)},[d,x]),i.useEffect(()=>{r&&n&&f&&c&&S&&(g({businessGuid:r,userGuid:n,facilityFeatures:f,selectedFacilityFeatures:c,businessProfile:S}),u(!1))},[r,n,f,c,S]),j?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(B,{children:e.jsxs(L,{title:"Social Media",children:[e.jsx(F,{baseUrl:"/web/account/portfolio/",guid:r,children:(s=l==null?void 0:l.businessProfile)==null?void 0:s.title}),r&&n&&e.jsx(M,{guid:r,userGuid:n}),l&&e.jsx(R,{userGuid:n,businessGuid:r,allSocialMedia:f,allSelectedSocialMedia:c})]})})};export{Y as default};
