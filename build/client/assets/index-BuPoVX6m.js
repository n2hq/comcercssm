import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as s}from"./components-CCwaTRgT.js";import{A as E}from"./AccountLayout-DO3oyorg.js";import{u as b}from"./AuthContext-BLT8eIBS.js";import{V as P,I as N,j as R}from"./lib-CC-22j43.js";import{u as A,s as C}from"./zod-PtQGc9r6.js";import{I,B as L}from"./Input-BAJOR40w.js";import{z as S}from"./index-C4bLmoCR.js";import{f as T,g as V}from"./WhiteLogo-E4eqNMj1.js";import{u as D}from"./NotificationContext-u_i63fMA.js";import{P as F}from"./ProfileContentLayout-CC3RBmKX.js";import"./UserMenu-CJEstezG.js";import"./index-CdGC67h0.js";import"./HomeNav-C-07gCFe.js";import"./SrchNavbar-DUfsO58m.js";import"./HamburgerSecondary-D_c9cnZn.js";import"./json-OCF5soII.js";import"./BusinessMenu-MNSt271k.js";const W=S.object({email:S.string({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"})}),k=({loaderData:o,user:t})=>{var h;const[i,d]=s.useState(null),[r,l]=s.useState(!1),n=D(),a=b();if(!a)return null;const u=p=>{let w=p.target.value,g=p.target.name;d(c=>({...c,[g]:w}))},m=async p=>{var j;l(!0),n.notify("Sending reset password request."),await new Promise(x=>setTimeout(x,1e3));const g={email:(j=a==null?void 0:a.user)==null?void 0:j.email.trim()},c=await a.resetpw(g);JSON.stringify(c).includes("Error")?(l(!1),n.alertCancel("",P(c))):(n.alertCancel("",P(c)),await new Promise(x=>setTimeout(x,1e3)),l(!1))},{register:f,handleSubmit:y,getValues:B,setValue:U,watch:q,setError:z,formState:{errors:v,isSubmitting:H}}=A({defaultValues:o.userProfile,resolver:C(W)});return e.jsx("form",{onSubmit:y(m),children:e.jsx("div",{className:`${T} mt-0  
                        rounded-lg pt-4 max-w-[500px] w-full mx-auto`,children:e.jsxs("div",{className:V,children:[e.jsx("div",{className:" text-xl text-gray-700 font-semibold border-b pb-1",children:"Reset Password"}),e.jsxs("div",{className:" pt-3 pb-4 text-[13px] leading-5",children:[e.jsx("b",{children:(h=o.userProfile)==null?void 0:h.email})," is your current email. It will be used be used for password resets or changes."]}),e.jsx("div",{className:"mt-[20px]"}),e.jsx(I,{controlTitle:"Your Email Address",controlPlaceholder:"Retype new password",controlName:"email",controlType:"text",disabled:!0,register:f,changeHandler:u,error:v.email}),e.jsx(L,{working:r,value:"Send Reset Email"})]})})})},le=()=>{s.useEffect(()=>{N(localStorage)},[]);const o=b();if(!o)return null;const{user:t}=o,[i,d]=s.useState(null),[r,l]=s.useState(null),[n,a]=s.useState(!0);return s.useEffect(()=>{async function u(m){const f=await R(m||"");d(f)}try{t!=null&&t.guid&&u(t==null?void 0:t.guid)}catch(m){console.log(m.message)}},[t==null?void 0:t.guid]),s.useEffect(()=>{i&&l({userProfile:i})},[i]),s.useEffect(()=>{r&&a(!1)},[r]),n?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(E,{children:e.jsxs(F,{title:"Reset Password",children:[i===null?"Loading...":"",r&&e.jsx(k,{loaderData:r,user:t})]})})};export{le as default};
