import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as i,c as N}from"./components-CCwaTRgT.js";import{m as E,I as k,J as P,Q as A,S as C,O as L}from"./lib-CC-22j43.js";import{A as B}from"./AccountLayout-DO3oyorg.js";import{C as F}from"./ContentLayout-B5RuURk1.js";import{u as M}from"./NotificationContext-u_i63fMA.js";import"./UserMenu-CJEstezG.js";import"./AuthContext-BLT8eIBS.js";import"./WhiteLogo-E4eqNMj1.js";import"./index-CdGC67h0.js";import"./HomeNav-C-07gCFe.js";import"./SrchNavbar-DUfsO58m.js";import"./HamburgerSecondary-D_c9cnZn.js";import"./json-OCF5soII.js";import"./BusinessMenu-MNSt271k.js";const R=({businessGuid:c,userGuid:v,allSocialMedia:r,allSelectedSocialMedia:m})=>{const[p,S]=i.useState(!1),o=M(),[f,x]=i.useState(null),[h,j]=i.useState(null),[l,d]=i.useState(null);i.useEffect(()=>{r&&m&&(x(r),j(m))},[r,m]),i.useEffect(()=>{if(f&&h){const t=f.map(a=>{const s=h.find(n=>n.media_id===a.media_id);return{...a,active:!!s,user_description:s?s.user_description:void 0}});d(t)}},[f,h]);const g=t=>{d(a=>a.map(s=>s.media_id===t?{...s,active:!s.active,user_description:s.user_description?s.user_description:""}:s))},u=(t,a)=>{d(s=>s.map(n=>n.media_id===t?{...n,user_description:a}:n))},b=async()=>{const s="https://edition.garssete.com"+"/api/listing/selected_social_media";S(!0),o.notify(),await new Promise(n=>setTimeout(n,1e3));try{const n=l.filter(_=>_.active).map(_=>({media_id:_.media_id,user_description:_.user_description}));(await fetch(s,{method:"POST",headers:E,body:JSON.stringify({user_guid:v,business_guid:c,selected:n})})).ok?o.alertReload("","Saved successfully!"):o.alert("","Failed to save.")}catch{o.alert("","Something happened!")}finally{S(!1)}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Select Social Media"}),r.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l==null?void 0:l.map(t=>e.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("input",{onChange:()=>g(t.media_id),type:"checkbox",checked:t.active,className:"hidden"}),e.jsx("div",{className:`w-5 h-5 border-[1px] border-black  rounded-none 
                                            ${t.active?"bg-blue-400":"bg-white"}`})]}),e.jsxs("div",{className:" w-full",children:[e.jsx("p",{className:"font-medium ",children:t.name}),e.jsx("div",{className:" w-full h-[50px] mt-1 rounded overflow-hidden",children:e.jsx("textarea",{onChange:a=>u(t.media_id,a.target.value),className:`w-full h-full bg-gray-100
                                            border p-3 text-sm`,value:t.user_description})})]})]},t.media_id))}),e.jsx("button",{onClick:b,className:"mt-5 px-4 py-2 bg-blue-600 text-white rounded",children:"Save Selected Social Media"})]})]})},X=()=>{i.useEffect(()=>{k(localStorage)},[]);const[c,v]=i.useState(""),[r,m]=i.useState(""),[p,S]=i.useState(null),[o,f]=i.useState(null),[x,h]=i.useState(null),[j,l]=i.useState(!0),{business_guid:d,user_guid:g}=N(),[u,b]=i.useState(null);return i.useEffect(()=>{const t=async(a,s)=>{v(a),m(s);const n=await A();S(n);const y=await C(s,a);f(y);const w=await L(a||"");b(w)};try{d&&g&&t(d,g)}catch(a){P(a)}},[d,g]),i.useEffect(()=>{c&&r&&p&&o&&u&&(h({businessGuid:c,userGuid:r,facilityFeatures:p,selectedFacilityFeatures:o,businessProfile:u}),l(!1))},[c,r,p,o,u]),j?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(B,{children:e.jsx(F,{title:"Social Media",businessGuid:c,data:x,businessProfile:u,children:x&&e.jsx(R,{userGuid:r,businessGuid:c,allSocialMedia:p,allSelectedSocialMedia:o})})})};export{X as default};
