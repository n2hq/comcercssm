import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as i,b as w}from"./components-qdL6XBti.js";import{p as E,I as A,J as L,K as N,L as P,N as k,O as C}from"./lib-ClTvlenw.js";import{A as B}from"./AccountLayout-DbrzReIn.js";import{C as R}from"./ContentLayout-HezYF_cE.js";import{u as D}from"./NotificationContext-DWfQct5-.js";import{u as O}from"./AuthContext-C3M4QnT1.js";import"./UserMenu-DhuDjlu1.js";import"./WhiteLogo-BbkPtNln.js";import"./index-DBZSphUT.js";import"./HomeNav-DquwwIxa.js";import"./SrchNavbar-BSFAt3zc.js";import"./json-CS1Ohf1x.js";import"./BusinessMenu-CGE5pLZJ.js";const T=({businessGuid:l,userGuid:y,facilityFeatures:n,selectedFacilityFeatures:m})=>{const[p,g]=i.useState(!1),c=D(),[f,S]=i.useState(null),[h,j]=i.useState(null),[d,o]=i.useState(null);i.useEffect(()=>{n&&m&&(S(n),j(m))},[n,m]),i.useEffect(()=>{if(f&&h){const s=f.map(r=>{const t=h.find(a=>a.feature_id===r.feature_id);return{...r,active:!!t,user_description:t?t.user_description:void 0}});o(s)}},[f,h]);const x=s=>{o(r=>r.map(t=>t.feature_id===s?{...t,active:!t.active,user_description:t.user_description?t.user_description:""}:t))},u=(s,r)=>{o(t=>t.map(a=>a.feature_id===s?{...a,user_description:r}:a))},v=async()=>{const t="https://edition.garssete.com"+"/api/listing/selected_facility_features";g(!0),c.notify(),await new Promise(a=>setTimeout(a,1e3));try{const a=d.filter(_=>_.active).map(_=>({feature_id:_.feature_id,user_description:_.user_description}));(await fetch(t,{method:"POST",headers:E,body:JSON.stringify({user_guid:y,business_guid:l,selected:a})})).ok?c.alertReload("","Saved successfully!"):c.alert("","Failed to save.")}catch{c.alert("","Something happened!")}finally{g(!1)}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Select Facility Features"}),n.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d==null?void 0:d.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("input",{onChange:()=>x(s.feature_id),type:"checkbox",checked:s.active,className:"hidden"}),e.jsx("div",{className:`w-5 h-5 border-2 rounded ${s.active?"bg-blue-700":"bg-white"}`})]}),e.jsxs("div",{className:" w-full",children:[e.jsxs("p",{className:"font-medium flex place-items-center gap-2 text-lg",children:[e.jsx("span",{className:"text-lg",children:s.icon}),e.jsx("span",{children:s.name})]}),e.jsx("p",{className:"text-xs ",children:s.description}),e.jsx("div",{className:" w-full h-[100px] mt-1 rounded overflow-hidden",children:e.jsx("textarea",{onChange:r=>u(s.feature_id,r.target.value),className:`w-full h-full bg-gray-100
                                            border p-3 text-sm`,value:s.user_description})})]})]},s.feature_id))}),e.jsx("button",{onClick:v,className:"mt-5 px-4 py-2 bg-blue-600 text-white rounded",children:"Save Selected Features"})]})]})},Y=()=>{i.useEffect(()=>{A(localStorage)},[]);const[l,y]=i.useState(""),[n,m]=i.useState(""),[p,g]=i.useState(null),[c,f]=i.useState(null),[S,h]=i.useState(null),[j,d]=i.useState(!0),{business_guid:o,user_guid:x}=w(),[u,v]=i.useState(null);return O()?(i.useEffect(()=>{const r=async(t,a)=>{y(t),m(a),await P(),g(N);const F=await k(a,t);f(F);const b=await C(t||"");v(b)};try{o&&x&&r(o,x)}catch(t){L(t)}},[o,x,N]),i.useEffect(()=>{l&&n&&p&&c&&u&&(h({businessGuid:l,userGuid:n,facilityFeatures:p,selectedFacilityFeatures:c,businessProfile:u}),d(!1))},[l,n,p,c,u]),j?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(B,{children:e.jsx(R,{businessGuid:l,data:S,businessProfile:u,title:"Facility Features",children:S&&e.jsx(T,{userGuid:n,businessGuid:l,facilityFeatures:p,selectedFacilityFeatures:c})})})):null};export{Y as default};
