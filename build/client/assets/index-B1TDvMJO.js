import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as i,b as w}from"./components-DN9bEK-g.js";import{h as E,b as P,c as A,d as B}from"./lib-D9DxbYYi.js";import{A as k,C}from"./ContentLayout-C9bAA6Bo.js";import{B as L}from"./BusinessMenu-BPFu39Ff.js";import{u as D}from"./NotificationContext-J94ES0yh.js";import{u as R}from"./AuthContext-C4x1D4OC.js";import"./MobileNav-B25ctNxH.js";import"./index-hDm6x0QN.js";import"./index-CJXUamzL.js";import"./index-BBHFZKyQ.js";import"./WhiteLogo-rJbwc0mv.js";import"./HomeNav-LlswaRun.js";const T=({businessGuid:o,userGuid:j,facilityFeatures:r,selectedFacilityFeatures:p})=>{const[f,S]=i.useState(!1),c=D(),[h,d]=i.useState(null),[g,v]=i.useState(null),[u,l]=i.useState(null);i.useEffect(()=>{r&&p&&(d(r),v(p))},[r,p]),i.useEffect(()=>{if(h&&g){const s=h.map(n=>{const t=g.find(a=>a.feature_id===n.feature_id);return{...n,active:!!t,user_description:t?t.user_description:void 0}});l(s)}},[h,g]);const x=s=>{l(n=>n.map(t=>t.feature_id===s?{...t,active:!t.active,user_description:t.user_description?t.user_description:""}:t))},_=(s,n)=>{l(t=>t.map(a=>a.feature_id===s?{...a,user_description:n}:a))},b=async()=>{const t="https://testgassete.gasimg.com"+"/api/listing/selected_facility_features";S(!0),c.notify(),await new Promise(a=>setTimeout(a,1e3));try{const a=u.filter(m=>m.active).map(m=>({feature_id:m.feature_id,user_description:m.user_description}));(await fetch(t,{method:"POST",headers:E,body:JSON.stringify({user_guid:j,business_guid:o,selected:a})})).ok?c.alertReload("","Saved successfully!"):c.alert("","Failed to save.")}catch{c.alert("","Something happened!")}finally{S(!1)}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Select Facility Features"}),r.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u==null?void 0:u.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("input",{onChange:()=>x(s.feature_id),type:"checkbox",checked:s.active,className:"hidden"}),e.jsx("div",{className:`w-5 h-5 border-2 rounded ${s.active?"bg-green-500":"bg-white"}`})]}),e.jsxs("div",{className:" w-full",children:[e.jsx("p",{className:"font-medium ",children:s.name}),e.jsx("p",{className:"text-xs ",children:s.description}),e.jsx("div",{className:" w-full h-[100px] mt-1 rounded overflow-hidden",children:e.jsx("textarea",{onChange:n=>_(s.feature_id,n.target.value),className:`w-full h-full bg-gray-100
                                            border p-3 text-sm`,children:s.user_description})})]})]},s.feature_id))}),e.jsx("button",{onClick:b,className:"mt-5 px-4 py-2 bg-blue-600 text-white rounded",children:"Save Selected Features"})]})]})},V=()=>{var n;const[o,j]=i.useState(""),[r,p]=i.useState(""),[f,S]=i.useState(null),[c,h]=i.useState(null),[d,g]=i.useState(null),[v,u]=i.useState(!0),{business_guid:l,user_guid:x}=w(),[_,b]=i.useState(null);return R()?(i.useEffect(()=>{l&&x&&(async(a,y)=>{j(a),p(y);const F=await P();S(F);const m=await A(y,a);h(m);const N=await B(a||"");b(N)})(l,x)},[l,x]),i.useEffect(()=>{o&&r&&f&&c&&_&&(g({businessGuid:o,userGuid:r,facilityFeatures:f,selectedFacilityFeatures:c,businessProfile:_}),u(!1))},[o,r,f,c,_]),v?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(k,{children:e.jsxs(C,{title:"Facility Features",children:[e.jsx("div",{className:"font-semibold mb-2 text-md",children:(n=d==null?void 0:d.businessProfile)==null?void 0:n.title}),o&&r&&e.jsx(L,{guid:o,userGuid:r}),d&&e.jsx(T,{userGuid:r,businessGuid:o,facilityFeatures:f,selectedFacilityFeatures:c})]})})):null};export{V as default};
