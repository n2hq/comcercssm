import{j as t}from"./jsx-runtime-0DLF9kdB.js";import{r as i,c as N}from"./components-CCwaTRgT.js";import{m as k,I as C,J as P,Q as A,S as B,O as L}from"./lib-CC-22j43.js";import{A as O}from"./AccountLayout-Cyc4nFOg.js";import{C as T}from"./ContentLayout-AZ7KUBkr.js";import{u as D}from"./OperationContext-CaoUEJma.js";import"./UserMenu-XEbZqAOR.js";import"./AuthContext-BLT8eIBS.js";import"./WhiteLogo-E4eqNMj1.js";import"./index-CdGC67h0.js";import"./HomeNav-C-07gCFe.js";import"./SrchNavbar-Bfx6m5q6.js";import"./HamburgerSecondary-D_c9cnZn.js";import"./json-OCF5soII.js";import"./BusinessMenu-MNSt271k.js";const F=({businessGuid:c,userGuid:w,allSocialMedia:o,allSelectedSocialMedia:f})=>{const[h,_]=i.useState(!1),{showOperation:u,showError:v,completeOperation:m,showSuccess:y}=D(),[g,E]=i.useState(null),[d,S]=i.useState(null),[n,x]=i.useState(null);i.useEffect(()=>{o&&f&&(E(o),S(f))},[o,f]),i.useEffect(()=>{if(g&&d){const e=g.map(a=>{const s=d.find(r=>r.media_id===a.media_id);return{...a,active:!!s,user_description:s?s.user_description:void 0}});x(e)}},[g,d]);const p=e=>{x(a=>a.map(s=>s.media_id===e?{...s,active:!s.active,user_description:s.user_description?s.user_description:""}:s))},l=(e,a)=>{x(s=>s.map(r=>r.media_id===e?{...r,user_description:a}:r))},j=async()=>{const s="https://edition.garssete.com"+"/api/listing/selected_social_media";_(!0),u("processing"),await new Promise(r=>setTimeout(r,1e3));try{const r=n.filter(b=>b.active).map(b=>({media_id:b.media_id,user_description:b.user_description}));(await fetch(s,{method:"POST",headers:k,body:JSON.stringify({user_guid:w,business_guid:c,selected:r})})).ok?(y("Success","Social media saved."),m()):(v("Error","Save failed."),m())}catch(r){console.log(r.message),v("Error","Save failed."),m()}finally{_(!1)}};return t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Select Social Media"}),o.length>0&&t.jsxs("div",{children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n==null?void 0:n.map(e=>t.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded cursor-pointer",children:[t.jsxs("div",{children:[t.jsx("input",{onChange:()=>p(e.media_id),type:"checkbox",checked:e.active,className:"hidden"}),t.jsx("div",{className:`w-5 h-5 border-[1px] border-black  rounded-none 
                                            ${e.active?"bg-blue-400":"bg-white"}`})]}),t.jsxs("div",{className:" w-full",children:[t.jsx("p",{className:"font-medium ",children:e.name}),t.jsx("div",{className:" w-full h-[50px] mt-1 rounded overflow-hidden",children:t.jsx("textarea",{onClick:a=>p(e.media_id),onChange:a=>l(e.media_id,a.target.value),className:`w-full h-full bg-gray-100
                                            border p-3 text-sm`,value:e.user_description,onBlur:a=>{a.currentTarget.value.length<=0&&p(e.media_id)}})})]})]},e.media_id))}),t.jsx("button",{onClick:j,className:"mt-5 px-4 py-2 bg-blue-600 text-white rounded",children:"Save Selected Social Media"})]})]})},ee=()=>{i.useEffect(()=>{C(localStorage)},[]);const[c,w]=i.useState(""),[o,f]=i.useState(""),[h,_]=i.useState(null),[u,v]=i.useState(null),[m,y]=i.useState(null),[g,E]=i.useState(!0),{business_guid:d,user_guid:S}=N(),[n,x]=i.useState(null);return i.useEffect(()=>{const p=async(l,j)=>{w(l),f(j);const e=await A();_(e);const a=await B(j,l);v(a);const s=await L(l||"");x(s)};try{d&&S&&p(d,S)}catch(l){P(l)}},[d,S]),i.useEffect(()=>{c&&o&&h&&u&&n&&(y({businessGuid:c,userGuid:o,facilityFeatures:h,selectedFacilityFeatures:u,businessProfile:n}),E(!1))},[c,o,h,u,n]),g?t.jsx("div",{className:"flex justify-center items-center h-screen",children:t.jsx("div",{className:"text-lg",children:"Loading..."})}):t.jsx(O,{children:t.jsx(T,{title:"Social Media",businessGuid:c,data:m,businessProfile:n,children:m&&t.jsx(F,{userGuid:o,businessGuid:c,allSocialMedia:h,allSelectedSocialMedia:u})})})};export{ee as default};
