import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as i,b as w}from"./components-DN9bEK-g.js";import{h as k,i as E,j as P,d as B}from"./lib-DkU1NRFm.js";import{A,C}from"./ContentLayout-C3eSLnVy.js";import{B as L}from"./BusinessMenu-BPFu39Ff.js";import{u as M}from"./NotificationContext-DQtpxZot.js";import"./MobileNav-D7FcM9wJ.js";import"./index-BuMB8ucW.js";import"./AuthContext-Bd05mLB0.js";import"./WhiteLogo-D0_DZqmS.js";import"./HomeNav-sGChEP8Q.js";const D=({businessGuid:o,userGuid:b,allSocialMedia:n,allSelectedSocialMedia:f})=>{const[p,_]=i.useState(!1),r=M(),[h,l]=i.useState(null),[x,j]=i.useState(null),[u,d]=i.useState(null);i.useEffect(()=>{n&&f&&(l(n),j(f))},[n,f]),i.useEffect(()=>{if(h&&x){const t=h.map(c=>{const s=x.find(a=>a.media_id===c.media_id);return{...c,active:!!s,user_description:s?s.user_description:void 0}});d(t)}},[h,x]);const g=t=>{d(c=>c.map(s=>s.media_id===t?{...s,active:!s.active,user_description:s.user_description?s.user_description:""}:s))},S=(t,c)=>{d(s=>s.map(a=>a.media_id===t?{...a,user_description:c}:a))},v=async()=>{const s="https://tynk.cc"+"/api/listing/selected_social_media";_(!0),r.notify(),await new Promise(a=>setTimeout(a,1e3));try{const a=u.filter(m=>m.active).map(m=>({media_id:m.media_id,user_description:m.user_description}));(await fetch(s,{method:"POST",headers:k,body:JSON.stringify({user_guid:b,business_guid:o,selected:a})})).ok?r.alertReload("","Saved successfully!"):r.alert("","Failed to save.")}catch{r.alert("","Something happened!")}finally{_(!1)}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Select Social Media"}),n.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u==null?void 0:u.map(t=>e.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("input",{onChange:()=>g(t.media_id),type:"checkbox",checked:t.active,className:"hidden"}),e.jsx("div",{className:`w-5 h-5 border-[1px] border-black  rounded-none 
                                            ${t.active?"bg-blue-400":"bg-white"}`})]}),e.jsxs("div",{className:" w-full",children:[e.jsx("p",{className:"font-medium ",children:t.name}),e.jsx("div",{className:" w-full h-[50px] mt-1 rounded overflow-hidden",children:e.jsx("textarea",{onChange:c=>S(t.media_id,c.target.value),className:`w-full h-full bg-gray-100
                                            border p-3 text-sm`,children:t.user_description})})]})]},t.media_id))}),e.jsx("button",{onClick:v,className:"mt-5 px-4 py-2 bg-blue-600 text-white rounded",children:"Save Selected Social Media"})]})]})},H=()=>{var t;const[o,b]=i.useState(""),[n,f]=i.useState(""),[p,_]=i.useState(null),[r,h]=i.useState(null),[l,x]=i.useState(null),[j,u]=i.useState(!0),{business_guid:d,user_guid:g}=w(),[S,v]=i.useState(null);return i.useEffect(()=>{d&&g&&(async(s,a)=>{b(s),f(a);const y=await E();_(y);const N=await P(a,s);h(N);const m=await B(s||"");v(m)})(d,g)},[d,g]),i.useEffect(()=>{o&&n&&p&&r&&S&&(x({businessGuid:o,userGuid:n,facilityFeatures:p,selectedFacilityFeatures:r,businessProfile:S}),u(!1))},[o,n,p,r,S]),j?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(A,{children:e.jsxs(C,{title:"Social Media",children:[e.jsx("div",{className:"font-semibold mb-2 text-md",children:(t=l==null?void 0:l.businessProfile)==null?void 0:t.title}),o&&n&&e.jsx(L,{guid:o,userGuid:n}),l&&e.jsx(D,{userGuid:n,businessGuid:o,allSocialMedia:p,allSelectedSocialMedia:r})]})})};export{H as default};
