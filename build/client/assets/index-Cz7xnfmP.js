import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r}from"./components-DN9bEK-g.js";import{A,C as N}from"./ContentLayout-TZmSGOXl.js";import{u as C}from"./AuthContext-4PD_dEDq.js";import{h as U,i as L,n as D}from"./lib-B7eVpA4v.js";import{z as w,u as T,s as R}from"./index-CORT_df8.js";import{I as k,B}from"./Input-C1XIRXaE.js";import{f as F,e as I}from"./WhiteLogo-Beb-GjTj.js";import{u as V}from"./NotificationContext-CXxn3nM7.js";import{C as W}from"./CardTitle-Vm8bzRht.js";import"./UserMenu-H2ZUKFg0.js";import"./index-DEp02NDL.js";import"./index-tIdn1r1K.js";import"./index-BFmBR9o8.js";import"./HomeNav-CkPKMOWD.js";import"./SrchNavbar-D-IA2MmT.js";import"./HamburgerSecondary-AL3BaTQ6.js";const _=w.object({email:w.string({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"})}),$=({loaderData:s,user:t})=>{var h,j,P;const[a,f]=r.useState(null),[i,m]=r.useState(!1),o=V(),d=l=>{let c=l.target.value,b=l.target.name;f(x=>({...x,[b]:c}))},u=async l=>{var y;m(!0);let c="";s.userProfile.active?c="Deactivating...":c="Activating...",o.notify(c),await new Promise(n=>setTimeout(n,1e3));const x="/api/user/activate_deactivate/"+s.userProfile.user_guid,S=L.BASE_URL+x;l.active=!((y=s.userProfile)!=null&&y.active);try{const n=await fetch(S,{method:"PUT",headers:U,body:JSON.stringify(l)});if(n.ok)o.alertReload("Success!",`You are now ${l.active?"activated":"deactivated"}`);else{let q=n.json().then(E=>{o.alertCancel("Error!",E.message)})}}catch(n){o.alertCancel("Error!",n.message)}finally{m(!1)}},{register:p,handleSubmit:g,getValues:Y,setValue:z,watch:H,setError:J,formState:{errors:v,isSubmitting:O}}=T({defaultValues:s.userProfile,resolver:R(_)});return e.jsx("form",{onSubmit:g(u),children:e.jsx("div",{className:`${F} mt-0  
                        rounded-lg pt-4 max-w-[500px] w-full mx-auto`,children:e.jsxs("div",{className:I,children:[e.jsx("div",{className:" text-xl text-gray-700 font-semibold border-b pb-1",children:(h=s.userProfile)!=null&&h.active?"Deactivate User":"Activate User"}),e.jsxs("div",{className:" pt-3 pb-4 text-[13px] leading-5",children:[e.jsx("b",{children:(j=s.userProfile)==null?void 0:j.email})," is your current email. It will be used for password resets or changes."]}),e.jsx("div",{className:"mt-[10px]"}),e.jsx(k,{controlTitle:"Your Email Address",controlPlaceholder:"Retype new password",controlName:"email",controlType:"text",disabled:!0,register:p,changeHandler:d,error:v==null?void 0:v.email}),e.jsx(B,{working:i,value:`${(P=s.userProfile)!=null&&P.active?"Deactivate":"Activate"} Profile`})]})})})},ue=()=>{const s=C();if(!s)return null;const{user:t}=s,[a,f]=r.useState(null),[i,m]=r.useState(null),[o,d]=r.useState(!0);return r.useEffect(()=>{async function u(p){const g=await D(p||"");f(g)}t!=null&&t.guid&&u(t==null?void 0:t.guid)},[t==null?void 0:t.guid]),r.useEffect(()=>{a&&m({userProfile:a})},[a]),r.useEffect(()=>{i&&d(!1)},[i]),o?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(A,{children:e.jsxs(N,{title:a.active?"Deactivate Profile":"Activate Profile",children:[a===null?"Loading...":"",e.jsx(W,{baseUrl:"/web/account/profile",guid:"",children:a==null?void 0:a.email}),i&&e.jsx($,{loaderData:i,user:t})]})})};export{ue as default};
