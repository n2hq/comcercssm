import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as i,b as w}from"./components-CooaLra5.js";import{l as E,I as A,r as B,t as P,v as k}from"./lib-Be6eG4oI.js";import{A as C,C as L}from"./ContentLayout-Crt2902l.js";import{B as D,a as R}from"./BusinessHeader-3Xg_4em3.js";import{u as T}from"./NotificationContext-B2aNOYuN.js";import{u as U}from"./AuthContext-WXd3jTth.js";import{f as N}from"./facility_features-BTZ1oaZl.js";import"./UserMenu-B_YWNS9l.js";import"./WhiteLogo-B7sT8thu.js";import"./index-wqb0JDJN.js";import"./HomeNav-CzpEOu6V.js";import"./SrchNavbar-Cuimr5XR.js";import"./HamburgerSecondary-BPEBjP1i.js";import"./CardTitle-ii5rf5je.js";import"./index-K6qbTPZ1.js";const I=({businessGuid:c,userGuid:_,facilityFeatures:r,selectedFacilityFeatures:m})=>{const[p,j]=i.useState(!1),l=T(),[f,h]=i.useState(null),[g,v]=i.useState(null),[u,o]=i.useState(null);i.useEffect(()=>{r&&m&&(h(r),v(m))},[r,m]),i.useEffect(()=>{if(f&&g){const t=f.map(n=>{const s=g.find(a=>a.feature_id===n.feature_id);return{...n,active:!!s,user_description:s?s.user_description:void 0}});o(t)}},[f,g]);const x=t=>{o(n=>n.map(s=>s.feature_id===t?{...s,active:!s.active,user_description:s.user_description?s.user_description:""}:s))},d=(t,n)=>{o(s=>s.map(a=>a.feature_id===t?{...a,user_description:n}:a))},y=async()=>{const s="https://garssete.gasimg.com"+"/api/listing/selected_facility_features";j(!0),l.notify(),await new Promise(a=>setTimeout(a,1e3));try{const a=u.filter(S=>S.active).map(S=>({feature_id:S.feature_id,user_description:S.user_description}));(await fetch(s,{method:"POST",headers:E,body:JSON.stringify({user_guid:_,business_guid:c,selected:a})})).ok?l.alertReload("","Saved successfully!"):l.alert("","Failed to save.")}catch{l.alert("","Something happened!")}finally{j(!1)}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Select Facility Features"}),r.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u==null?void 0:u.map(t=>e.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("input",{onChange:()=>x(t.feature_id),type:"checkbox",checked:t.active,className:"hidden"}),e.jsx("div",{className:`w-5 h-5 border-2 rounded ${t.active?"bg-blue-700":"bg-white"}`})]}),e.jsxs("div",{className:" w-full",children:[e.jsxs("p",{className:"font-medium flex place-items-center gap-2 text-lg",children:[e.jsx("span",{className:"text-lg",children:t.icon}),e.jsx("span",{children:t.name})]}),e.jsx("p",{className:"text-xs ",children:t.description}),e.jsx("div",{className:" w-full h-[100px] mt-1 rounded overflow-hidden",children:e.jsx("textarea",{onChange:n=>d(t.feature_id,n.target.value),className:`w-full h-full bg-gray-100
                                            border p-3 text-sm`,value:t.user_description})})]})]},t.feature_id))}),e.jsx("button",{onClick:y,className:"mt-5 px-4 py-2 bg-blue-600 text-white rounded",children:"Save Selected Features"})]})]})},se=()=>{i.useEffect(()=>{A(localStorage)},[]);const[c,_]=i.useState(""),[r,m]=i.useState(""),[p,j]=i.useState(null),[l,f]=i.useState(null),[h,g]=i.useState(null),[v,u]=i.useState(!0),{business_guid:o,user_guid:x}=w(),[d,y]=i.useState(null);return U()?(i.useEffect(()=>{o&&x&&(async(s,a)=>{_(s),m(a),await B(),j(N);const F=await P(a,s);f(F);const b=await k(s||"");y(b)})(o,x)},[o,x,N]),i.useEffect(()=>{c&&r&&p&&l&&d&&(g({businessGuid:c,userGuid:r,facilityFeatures:p,selectedFacilityFeatures:l,businessProfile:d}),u(!1))},[c,r,p,l,d]),v?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(C,{children:e.jsxs(L,{businessGuid:c,data:h,businessProfile:d,title:"Facility Features",children:[e.jsx(D,{businessGuid:c,data:h,businessProfile:d}),c&&r&&e.jsx(R,{guid:c,userGuid:r}),h&&e.jsx(I,{userGuid:r,businessGuid:c,facilityFeatures:p,selectedFacilityFeatures:l})]})})):null};export{se as default};
