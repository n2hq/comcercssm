import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as a}from"./components-qdL6XBti.js";import{A}from"./AccountLayout-DqEKwYFJ.js";import{u as N}from"./AuthContext-BnKqVxnU.js";import{p as U,z as L,I as C,j as D}from"./lib-gdbuLEb8.js";import{u as I,s as R}from"./zod-g2XesUsp.js";import{I as T,B as k}from"./Input-BGESB1pz.js";import{z as w}from"./index-C4bLmoCR.js";import{f as B,g as F}from"./WhiteLogo-BTe8ysqQ.js";import{u as V}from"./NotificationContext-BN71CfFW.js";import{P as W}from"./ProfileContentLayout-BTr2le8U.js";import"./UserMenu-CECLlKRK.js";import"./index-CeMHKdet.js";import"./HomeNav-CYWF0wT0.js";import"./SrchNavbar-AcngZQKL.js";import"./json-BNowKBeR.js";import"./BusinessMenu-CriD0Rgx.js";const _=w.object({email:w.string({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"})}),$=({loaderData:s,user:t})=>{var h,P,j;const[r,d]=a.useState(null),[i,u]=a.useState(!1),o=V(),p=l=>{let m=l.target.value,y=l.target.name;d(x=>({...x,[y]:m}))},f=async l=>{var b;u(!0);let m="";s.userProfile.active?m="Deactivating...":m="Activating...",o.notify(m),await new Promise(n=>setTimeout(n,1e3));const x="/api/user/activate_deactivate/"+s.userProfile.user_guid,S=L.BASE_URL+x;l.active=!((b=s.userProfile)!=null&&b.active);try{const n=await fetch(S,{method:"PUT",headers:U,body:JSON.stringify(l)});if(n.ok)o.alertReload("Success!",`You are now ${l.active?"activated":"deactivated"}`);else{let q=n.json().then(E=>{o.alertCancel("Error!",E.message)})}}catch(n){o.alertCancel("Error!",n.message)}finally{u(!1)}},{register:c,handleSubmit:g,getValues:z,setValue:Y,watch:H,setError:J,formState:{errors:v,isSubmitting:O}}=I({defaultValues:s.userProfile,resolver:R(_)});return e.jsx("form",{onSubmit:g(f),children:e.jsx("div",{className:`${B} mt-0  
                        rounded-lg pt-4 max-w-[500px] w-full mx-auto`,children:e.jsxs("div",{className:F,children:[e.jsx("div",{className:" text-xl text-gray-700 font-semibold border-b pb-1",children:(h=s.userProfile)!=null&&h.active?"Deactivate User":"Activate User"}),e.jsxs("div",{className:" pt-3 pb-4 text-[13px] leading-5",children:[e.jsx("b",{children:(P=s.userProfile)==null?void 0:P.email})," is your current email. It will be used for password resets or changes."]}),e.jsx("div",{className:"mt-[10px]"}),e.jsx(T,{controlTitle:"Your Email Address",controlPlaceholder:"Retype new password",controlName:"email",controlType:"text",disabled:!0,register:c,changeHandler:p,error:v==null?void 0:v.email}),e.jsx(k,{working:i,value:`${(j=s.userProfile)!=null&&j.active?"Deactivate":"Activate"} Profile`})]})})})},ue=()=>{a.useEffect(()=>{C(localStorage)},[]);const s=N();if(!s)return null;const{user:t}=s,[r,d]=a.useState(null),[i,u]=a.useState(null),[o,p]=a.useState(!0);return a.useEffect(()=>{async function f(c){const g=await D(c||"");d(g)}try{t!=null&&t.guid&&f(t==null?void 0:t.guid)}catch(c){console.log(c.message)}},[t==null?void 0:t.guid]),a.useEffect(()=>{r&&u({userProfile:r})},[r]),a.useEffect(()=>{i&&p(!1)},[i]),o?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(A,{children:e.jsxs(W,{title:r.active?"Deactivate Profile":"Activate Profile",children:[r===null?"Loading...":"",i&&e.jsx($,{loaderData:i,user:t})]})})};export{ue as default};
