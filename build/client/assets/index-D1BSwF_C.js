import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{z as c,u as S,s as P}from"./index-CORT_df8.js";import{r as a,a as k,L as f,c as U}from"./components-DN9bEK-g.js";import{w as R,W as E}from"./WhiteLogo-DWYdHO24.js";import{u as L}from"./AuthContext-DU8v9kFw.js";import{u as C}from"./NotificationContext-BM4fJMZY.js";import{l as $,h as g,f as A}from"./lib-CwGU7Ewq.js";const h=new RegExp(/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!()Â£@$%^&*-]).{8,}$/),_=c.object({password:c.string().min(1,{message:"Please enter new password."}).min(8,{message:"Password must be up to 8 characters."}).regex(h,{message:"Please enter a valid password"}),password2:c.string().min(1,{message:"Please enter new password."}).min(8,{message:"Password must be at least 8 characters."}).regex(h,{message:"Please enter a valid password"})}).superRefine((t,r)=>{t.password!==t.password2&&r.addIssue({code:c.ZodIssueCode.custom,path:["password2"],message:"Your new password don't match"})}),T=({guid:t})=>{const[r,i]=a.useState("Loading..."),[d,w]=a.useState(null),[W,B]=a.useState(null);if(!L())return null;const[F,m]=a.useState(!1),p=C();k();const[b,O]=a.useState(!1),j=async o=>{m(!0),p.notify("","Working..."),await new Promise(s=>setTimeout(s,1e3)),o.password;const n="https://garssete.gasimg.com",l=`/api/user/reset_password/${t}`,u=n+l;try{const s=await fetch(u,{method:"PUT",headers:g,body:JSON.stringify(o)});if(s.ok)p.alertCancel("Success!","Password Successfully Changed! Use new password on next login");else{let x=s.json().then(N=>{p.alertCancel("Error!",N.message)})}}catch{return}finally{m(!1)}await new Promise(s=>setTimeout(s,1e3)),m(!1)},y=async o=>{const n=`/api/user/verify_signup/${o}`,l=A.BASE_URL+n,u={};try{const s=await fetch(l,{method:"PUT",headers:g,body:JSON.stringify(u)}),x=await s.json();s.ok||i(`${x.message||"Unknown error"}`),i(x.message)}catch(s){i(`${s.message||"Unexpected error occurred"}`)}},{register:z,handleSubmit:v,getValues:I,watch:J,setError:Z,formState:{errors:G,isSubmitting:Y}}=S({defaultValues:{},resolver:P(_)});return a.useEffect(()=>{t&&(async n=>{const l=await $(n);w(l)})(t)},[t]),a.useEffect(()=>{d!==null&&y(d.user_hash)},[d]),e.jsxs("div",{className:`w-[80%] h-fit grid grid-cols-1 lg:grid-cols-2
        mt-[100px] mb-[20px]  `,children:[e.jsx("div",{className:"hidden lg:block "}),e.jsx("div",{className:"place-content-center flex lg:place-content-end col-span-12 md:col-span-1",children:e.jsx("form",{onSubmit:v(j),children:e.jsxs("div",{className:`w-[350px] bg-white h-full rounded-2xl
                    flex flex-col place-items-center pt-[40px] pb-[40px]
                    px-[10px] `,children:[e.jsx("div",{className:R,children:e.jsx(E,{})}),e.jsx("div",{className:`text-[22px] text-center
                        mt-[30px] font-bold text-black`,children:"Signup Complete"}),e.jsx("div",{className:`text-[15px] text-center
                        mt-[0px] font-light text-black`,children:"you can now signin with your email"}),e.jsx("section",{className:`w-full
                            ${b&&"hidden"}`,children:e.jsx("div",{className:`w-full  mt-[30px] 
                        `,children:e.jsx("div",{className:`bg-yellow-100/70
                                     text-center py-3 text-[14px]
                                    mx-[10px] rounded px-3`,children:r})})}),e.jsx("div",{className:`w-full flex flex-col 
                                            place-items-center mt-[30px] `,children:e.jsx(f,{className:"w-[85%]",to:"/web/signin",children:e.jsx("div",{className:`border-b w-full
                                                    px-[0px] py-1 text-[14px]
                                                    outline-none hover:underline`,children:"Already have and account? Sign in"})})}),e.jsx("div",{className:`w-full flex flex-col 
                                            place-items-center mt-[20px]`,children:e.jsx(f,{to:"/web/signup",className:"w-[85%]",children:e.jsxs("button",{className:`w-full 
                                                py-[2px] text-[14px] rounded-full text-center
                                                text-blue-700 hover:bg-gray-100`,children:["No account yet? ",e.jsx("span",{className:"text-black",children:"Create an account"})]})})})]})})})]})},V=({userGuid:t})=>e.jsx("div",{className:`bg-white w-full 
        md:bg-[url('https://images.pexels.com/photos/290386/pexels-photo-290386.jpeg?auto=compress&cs=tinysrgb&w=1200')]
        bg-cover bg-center min-h-screen flex place-content-center`,children:e.jsx(T,{guid:t})}),se=()=>{const r=U().guid;return e.jsx("div",{children:e.jsx(V,{userGuid:r})})};export{se as default};
