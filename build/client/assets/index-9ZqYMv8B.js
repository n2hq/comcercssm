import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r,L as R,c as le}from"./components-kAvIA9Ge.js";import{u as z,I as ce}from"./SliderContext-D8R9OPqn.js";import{u as U,z as de,j as T,N as re,O as ne,P as oe,Q as xe,R as me,a as D,S as ie,T as F,U as he,V as pe,L as je}from"./index-Dn2vcGOX.js";import{u as ue,s as ge,z as S}from"./index-CLh2UBG4.js";import{u as O}from"./NotificationContext-s3rHZtot.js";import{e as ve,f as Ne,g as fe,B as we,a as ye}from"./MobileNav-B27kFNDs.js";import{L as Se,F as _e}from"./LatestStarRating-C_m0GYeS.js";import{G as Re}from"./GenericNav-CPZ6WEE4.js";import"./index-BTxVYS91.js";import"./WhiteLogo-Xon5mzjA.js";import"./UserMenu-kU8-jY07.js";const V=r.createContext(null);function be(){const t=r.useContext(V);if(!t)throw new Error("useGallery must be used within a GalleryProvider");return t}const ke=({children:t})=>{const[s,a]=r.useState(!1),[l,x]=r.useState(null),d=z(),[n,i]=r.useState(null),p="https://oxbyt.com",u=()=>a(!1);let v={setShow:a,setGallery:x,setListing:i};const m=o=>{d.setDialog(!0),d.setSelectedSlide(o+1),d.setGallery(l)};return e.jsxs(V.Provider,{value:v,children:[s&&e.jsxs("div",{onMouseDown:o=>a(!1),className:`flex w-screen h-screen bg-black/40 
                        z-[3000] fixed top-0 left-0 right-0 bottom-0
                        place-items-center place-content-center px-[15px]`,children:[e.jsx("div",{onMouseDown:o=>o.stopPropagation(),className:`w-[95%] sm:w-[95%] md:w-[80%] max-h-[80%] mx-auto
                         bg-white rounded-lg shadow-lg shadow-black/50 space-y-6
                         z-[3100] overflow-hidden`,children:e.jsxs("div",{className:"w-full h-full",children:[e.jsx("div",{className:"border-b py-3 px-3",children:e.jsxs("div",{className:`font-bold text-gray-700
                                    text-xl w-[80%]  truncate`,children:["Gallery for ",n&&(n==null?void 0:n.title)]})}),e.jsx("div",{className:`grid grid-cols-4 md:grid-cols-6 gap-2 
                                h-full overflow-y-auto pt-2 px-2 pb-2
                                bg-gray-800 `,children:l&&(l==null?void 0:l.map((o,j)=>e.jsx("div",{onClick:()=>m(j),className:`relative hover:cursor-pointer
                                                 bg-red-200 h-[80px] md:h-[100px] lg:h-[120px] rounded-md
                                                 overflow-hidden`,children:e.jsx("img",{className:"object-cover w-full h-full",src:p+o.image_url,alt:""})})))})]})}),e.jsx("div",{onMouseDown:()=>u(),className:`w-[50px] h-[50px] z-[300] bg-white
                                flex place-content-center place-items-center
                                rounded-full absolute left-2 top-2 cursor-pointer
                                hover:bg-white/40 transition duration-1000 ease-in-out`,children:e.jsx(ce,{className:"text-[30px]"})})]}),t]})},_=100,K=r.createContext(null);function Ce(){const t=r.useContext(K);if(!t)throw new Error("useRating must be used within a RatingProvider");return t}const Le=S.object({fullname:S.any(),rating:S.any(),comment:S.any()});function De({children:t}){var G,B,M;const[s,a]=r.useState(!1),[l,x]=r.useState(!1),[d,n]=r.useState(null),[i,p]=r.useState(void 0),[u,v]=r.useState(""),m=O(),[o,j]=r.useState(5);let{user:b}=U();const[ze,H]=r.useState(null),[J,y]=r.useState(!1),E=c=>c.trim()===""?0:c.trim().split(/\s+/).length,k=c=>{let h=c.target.value,g=c.target.name;H(f=>({...f,[g]:h}))},{register:C,handleSubmit:Q,getValues:Ue,setValue:L,watch:q,reset:X,setError:Te,formState:{errors:N,isSubmitting:Oe}}=ue({resolver:ge(Le)}),Y=c=>{const h=c.target.value,g=h.trim().split(/\s+/);if(g.length<=_)L("text",h),y(!1);else{y(!0);const f=g.slice(0,_).join(" ");L("text",f)}},Z=async c=>{m.notify("Working..."),await new Promise(w=>setTimeout(w,1e3));const h=b.guid,g=d.gid;c.user_guid=h,c.business_guid=g;const se="https://tynk.cc"+"/api/rating";try{const w=await fetch(se,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),ae=await w.json();w.ok?m.alert("Success","Rating submitted successfully!"):m.alert("Error",ae.error)}catch(w){m.alert("",w.message)}};let P={show:s,setShow:a,setListing:n,reset:X,setRatingData:p,validateData:async(c,h)=>{if((c==null?void 0:c.length)===0){let g=(h==null?void 0:h.first_name)||"",f=(h==null?void 0:h.last_name)||"",A=g+" "+f;L("fullname",A)}}};const ee=q("text")||"",te=c=>{ee.trim().split(/\s+/).length>=_&&c.key!=="Backspace"&&c.key!=="Delete"&&!c.ctrlKey?(c.preventDefault(),y(!0)):y(!1)};return e.jsxs(K.Provider,{value:P,children:[s&&e.jsx("div",{className:`flex w-screen h-screen bg-black/40 z-[3000] 
                fixed top-0 left-0 right-0 bottom-0 place-items-center place-content-center`,children:e.jsxs("div",{className:"w-[450px] h-fit mx-auto p-6 bg-white rounded-xl shadow-md space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Create/Edit Rating"}),e.jsxs("form",{onSubmit:Q(Z),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-semibold",children:"Full Name"}),e.jsx("input",{...C("fullname",{onChange:k}),type:"text",className:"w-full px-3 py-2 border rounded-md",placeholder:"Enter Business GUID"}),((G=N.fullname)==null?void 0:G.message)&&e.jsx("div",{className:"text-red-500 mt-1 text-sm",children:N.fullname.message.toString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-semibold",children:"Stars"}),e.jsx("select",{...C("rating",{onChange:c=>{j(Number(c.target.value)),k(c)}}),className:"w-full px-3 py-2 border rounded-md",children:[5,4,3,2,1].map(c=>e.jsxs("option",{value:c,children:[c," Star",c>1?"s":""]},c))}),((B=N.rating)==null?void 0:B.message)&&e.jsx("div",{className:"text-red-500 mt-1 text-sm",children:N.rating.message.toString()})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex place-content-between",children:[e.jsx("label",{className:"block mb-1 text-sm font-semibold",children:"Comment"}),e.jsxs("label",{className:" text-gray-600 text-sm",children:["Word Count: ",e.jsx("strong",{children:E(u)})]})]}),e.jsx("textarea",{...C("comment",{onChange:c=>{E(u)<=_?(v(c.target.value),Y(c),k(c)):c.preventDefault()}}),onKeyDown:te,className:"w-full px-3 py-2 border rounded-md text-sm",placeholder:"Write your review...",rows:4}),J&&e.jsx("div",{className:"text-red-500 mt-0 text-sm",children:"Maximum maximumWords words allowed."}),((M=N.comment)==null?void 0:M.message)&&e.jsx("div",{className:"text-red-500 mt-0 text-sm",children:N.comment.message.toString()})]}),e.jsxs("div",{className:"w-full grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:()=>a(!1),className:`w-full bg-red-200 rounded-md
                                        hover:bg-red-100`,children:"Close"}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700",children:l?"Submitting...":"Submit Rating"})]})]})]})}),t]})}const Ee=({listing:t})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-[19px] md:text-[24px] font-bold mt-[5px] leading-7",children:t==null?void 0:t.title}),e.jsxs("div",{className:"text-[13px] mt-1.5 leading-[1.2em]",children:[t!=null&&t.address_one?`${t==null?void 0:t.address_one}, `:"",t!=null&&t.address_two?`${t==null?void 0:t.address_two}, `:"",t!=null&&t.city_name?`${t==null?void 0:t.city_name}, `:"",t!=null&&t.state_name?`${t==null?void 0:t.state_name}, `:"",t==null?void 0:t.country_name]})]}),Ge=({images:t,listing:s})=>{const a="https://oxbyt.com",[l,x]=r.useState([]),d=z(),n=be(),[i,p]=r.useState([]);r.useEffect(()=>{let m=[...l];t&&(t.map((o,j)=>{j+1<12&&m.push(o)}),p(m))},[t]);const u=m=>{d.setDialog(!0),d.setSelectedSlide(m+1),d.setGallery(t),d.setListing(s)},v=m=>{n.setShow(!0),n.setGallery(t),n.setListing(s)};return e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-2 ",children:[i.length>1&&i.map((m,o)=>e.jsx("div",{children:e.jsx("div",{className:`h-[80px] sm:h-[100px] lg:h-[100px]
                                    hover:cursor-pointer`,onMouseDown:j=>u(o),children:e.jsx("img",{src:a+m.image_url,alt:m.alt,className:`object-cover w-full h-full rounded-md shadow-md 
                                                transition-transform`})},o)},o)),i.length>1&&e.jsx("div",{onMouseDown:m=>v(),className:" h-[80px] sm:h-[100px] lg:h-[100px] relative",children:e.jsxs("div",{className:`w-full h-full rounded-md shadow-md 
                                            transition-transform bg-black/80 flex flex-col
                                            place-items-center place-content-center text-white
                                            text-[13px] cursor-pointer text-wrap`,children:[e.jsx(ve,{})," view all..."]})})]}),i.length>1&&e.jsx("div",{className:"h-2"})]})},Be=({listing:t})=>{const[s,a]=r.useState("");return r.useEffect(()=>{t.gid&&de(t.gid).then(x=>{a(T.IMG_BASE_URL+x.image_url)})},[t]),e.jsxs("div",{className:"mt-12",children:[e.jsx("div",{className:"font-bold text-lg",children:"About this business"}),e.jsxs("div",{className:`flex place-items-start place-content-start
                gap-2 mt-4 mb-3`,children:[e.jsx("div",{className:`rounded-full bg-black w-[30px] h-[30px]
                    overflow-hidden relative`,children:e.jsx("img",{className:"object-cover w-full h-full",src:s,alt:""})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-md font-bold tracking-tight leading-[1.2em]",children:t.title}),e.jsx("div",{className:"text-[12px] capitalize",children:t.category})]})]}),e.jsx("div",{className:"flex flex-col gap-y-5 text-[14px] mt-4 whitespace-pre-wrap",children:t==null?void 0:t.long_description})]})},I=({businessProfile:t})=>e.jsxs("div",{className:"bg-blue-50/50 rounded-[5px] overflow-hidden  px-0 pt-0 pb-5 w-full",children:[e.jsx("div",{className:`font-bold text-[18px] border-b pb-2 
                 shadow-gray-700/40 px-3 bg-blue-100/50 pt-3`,children:"Contact"}),e.jsx("div",{className:"h-[30px]"}),e.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-3 lg:grid-cols-1 
            text-[14px] space-y-4 lg:space-y-4 tracking-tight
            md:space-x-4 lg:space-x-0 text-black/80 font-sans
            px-3`,children:[e.jsx("div",{className:" w-full",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-1 ",children:e.jsx(re,{className:"text-[22px]"})}),e.jsxs("div",{className:`col-span-11 leading-[1.2em] ml-2
                            text-[13px]`,children:[(t==null?void 0:t.address_one)+", ",(t==null?void 0:t.address_two)!==null?(t==null?void 0:t.address_two)+", ":"",(t==null?void 0:t.city_name)!==null?(t==null?void 0:t.city_name)+", ":"",(t==null?void 0:t.state_name)!==null?(t==null?void 0:t.state_name)+", ":"",(t==null?void 0:t.zipcode)!==null?(t==null?void 0:t.zipcode)+", ":"",t==null?void 0:t.country_name]})]})}),e.jsx("div",{className:"  w-full",children:e.jsx(R,{to:`tel:${t==null?void 0:t.phone}`,children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(ne,{className:"text-[22px]"})}),e.jsx("div",{className:"col-span-11 leading-[1.2em] ml-2",children:t==null?void 0:t.phone})]})})}),e.jsx("div",{className:"  w-full",children:e.jsx(R,{to:`${t==null?void 0:t.website}`,children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:`col-span-1 relative top-0
                            `,children:e.jsx(oe,{className:"text-[22px]"})}),e.jsx("div",{className:`col-span-11 leading-[1.2em] ml-2 top-0
                            flex place-items-center`,children:"Website"})]})})}),e.jsx("div",{className:"  w-full",children:e.jsx(R,{to:`mailto:${t==null?void 0:t.email_address}`,children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:`col-span-1 relative top-0
                            `,children:e.jsx(xe,{className:"text-[22px]"})}),e.jsx("div",{className:`col-span-11 leading-[1.2em] ml-2 top-0
                            flex place-items-center`,children:"Email Address"})]})})})]})]}),$=({listing:t})=>{const s=Ce(),{user:a}=U(),l=O();r.useEffect(()=>{t!=null&&t.gid&&(a!=null&&a.guid)&&(s.setListing(t),me(a.guid,t.gid).then(n=>{(n==null?void 0:n.length)!==0?(s.reset(n),s.setRatingData(n)):s.validateData(n,a)}))},[t,a]);const x=n=>{n?(l.cancel(),window.location.href="/signin"):l.cancel()},d=()=>{(a==null?void 0:a.guid)===null||(a==null?void 0:a.guid)===void 0?l.confirm("Login to continue",x):s.setShow(!0)};return e.jsx("div",{className:"mx-auto w-full sm:w-[60%] lg:w-full mt-3",children:e.jsx("button",{onClick:()=>d(),className:`bg-blue-500 text-white flex flex-col
                items-center py-2 w-full `,children:"Write Review"})})},Me=({ratingsData:t,rating:s=3.5,maxStars:a=5})=>{const l=[];for(let x=1;x<=a;x++)x<=s?l.push(e.jsx("span",{className:"text-green-700 text-md",children:e.jsx(Ne,{})},x)):l.push(e.jsx("span",{className:`text-green-700 text-md rounded-full
                overflow-hidden`,children:e.jsx(fe,{className:"bg-green-100"})},x));return e.jsxs("div",{className:" flex w-full place-items-center gap-2 mt-6",children:[e.jsx("div",{className:"flex  gap-x-[3px] -mt-[2px]",children:l}),e.jsx("div",{className:"text-gray-400",children:e.jsx(D,{className:"text-[15px] text-green-700"})}),e.jsxs("div",{className:" text-sm",children:["Rating: ",s]}),e.jsx("div",{className:"text-gray-400",children:e.jsx(D,{className:"text-[15px] text-green-700"})}),e.jsxs("div",{className:"text-sm",children:["Reviews: ",Number(t.rating_count)]})]})},Ae=({listing:t})=>{const[s,a]=r.useState(void 0);return r.useEffect(()=>{ie(t.gid).then(l=>{a(l)})},[t.business_guid]),e.jsxs("div",{className:" mt-12",children:[e.jsx("div",{className:" font-bold text-xl",children:"Features"}),e.jsx("div",{className:"grid grid-cols-2 gap-4 mt-3",children:s==null?void 0:s.map((l,x)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"font-bold",children:l.name}),e.jsx("div",{className:"text-sm mt-[-2px] text-gray-500 leading-[1.2em] tracking-normal",children:l.user_description||l.description})]},x))})]})},Fe=({listing:t})=>e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-lg font-bold",children:"Intro"}),e.jsx("div",{className:" text-[14px] flex flex-col gap-y-4 whitespace-pre-wrap",children:t.short_description})]}),W=({rating:t=3.5,maxStars:s=5})=>{const a=[];for(let l=1;l<=s;l++)l<=t?a.push(e.jsx("span",{className:"text-yellow-500 text-lg",children:e.jsx(we,{})},l)):a.push(e.jsx("span",{className:"text-yellow-500 text-lg",children:e.jsx(ye,{})},l));return e.jsxs("div",{className:" flex w-full place-items-center gap-2 mt-0",children:[e.jsx("div",{className:"flex  gap-x-[3px] -mt-[2px]",children:a}),e.jsx("div",{className:"text-gray-400",children:e.jsx(D,{className:"text-[15px] text-yellow-400"})}),e.jsxs("div",{className:" text-sm",children:["Rating: ",Number(t).toFixed(0)]})]})},Ie=({listing:t})=>{const[s,a]=r.useState([]),[l,x]=r.useState({});return r.useEffect(()=>{const d=async i=>{i&&await he(i).then(p=>{a(p)})},n=async i=>{i&&await pe(i).then(p=>{x(p)})};t.gid&&(d(t.gid),n(t.gid))},[t]),e.jsxs("div",{className:"mt-12",children:[e.jsx("div",{className:"text-xl font-bold",children:"Reviews"}),e.jsxs("div",{className:"-mt-1 text-[14px] flex flex-col -gap-y-1 font-light",children:[e.jsx("div",{className:"font-bold",children:"Overall Rating:"}),l&&e.jsx(W,{rating:l==null?void 0:l.rating_average})]}),e.jsx("hr",{className:"mt-3"}),e.jsx("div",{className:"flex flex-col gap-y-4 divide-y-[1px]",children:s!==null&&(s==null?void 0:s.map((d,n)=>e.jsxs("div",{className:"pt-7 pb-4",children:[e.jsxs("div",{className:"flex place-items-start gap-2",children:[e.jsx("div",{className:`w-[30px] h-[30px] rounded-full
                                        bg-black overflow-hidden`,children:e.jsx("img",{src:T.IMG_BASE_URL+d.image_url,alt:""})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-sm font-bold",children:d.fullname}),e.jsx("div",{className:"text-[12px]",children:`${d==null?void 0:d.city_name}, ${d==null?void 0:d.state_name}`}),e.jsx("div",{className:"text-[12px]",children:`${d==null?void 0:d.country_name}`})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{children:e.jsx(W,{rating:d.rating})}),e.jsxs("div",{className:"text-[12px] flex gap-1 place-items-center",children:[e.jsx("b",{children:"Created at:"}),e.jsx("span",{className:"text-[12px]",children:F(d.created_at)})]}),e.jsxs("div",{className:"text-[12px] flex gap-1 place-items-center",children:[e.jsx("b",{children:"Last Edited:"}),e.jsx("span",{className:"text-[12px]",children:F(d.updated_at)})]}),e.jsx("div",{className:"text-[14px] mt-2",children:d.comment})]})]},n)))})]})},$e=({listing:t,images:s,ratingsData:a})=>e.jsx("div",{className:"px-[15px]",children:e.jsxs("div",{className:"max-w-[1100px] w-full mx-auto bg-white",children:[a&&e.jsx(Me,{ratingsData:a,rating:Number(a.rating_average)}),t&&e.jsx(Ee,{listing:t}),e.jsxs("div",{className:"grid grid-cols-12 mt-4 gap-0 md:gap-12 relative",children:[e.jsxs("div",{className:" col-span-12 lg:col-span-8",children:[s&&t&&e.jsx(Ge,{images:s,listing:t}),e.jsxs("div",{className:"lg:hidden mt-5 mb-5",children:[t&&e.jsx(I,{businessProfile:t}),t&&e.jsx($,{listing:t})]}),e.jsx(Fe,{listing:t}),e.jsx(Ae,{listing:t}),e.jsx(Be,{listing:t}),t&&e.jsx(Ie,{listing:t})]}),e.jsx("div",{className:"col-span-12 lg:col-span-4 hidden lg:block",children:e.jsxs("div",{className:" sticky top-[100px]",children:[t&&e.jsx(I,{businessProfile:t}),e.jsx($,{})]})})]})]})}),We=({title:t,subtitle:s,category:a,limit:l})=>{const[x,d]=r.useState(""),[n,i]=r.useState(""),[p,u]=r.useState([]),v="https://oxbyt.com";r.useEffect(()=>{t&&s&&(d(t),i(s))},[t,s]);let m=async(o,j)=>{if(j&&o){let b=await je(o,j);u(b)}};return r.useEffect(()=>{l&&a&&m(a,l)},[l,a]),e.jsx("div",{className:"w-[95%] md:w-[90%] xl:w-[80%] mx-auto",children:e.jsxs("div",{className:"mt-10 border-t pt-5",children:[e.jsxs("div",{className:" mb-[20px] ",children:[e.jsx("div",{className:"font-semibold text-xl",children:x}),e.jsx("div",{className:"text-sm -mt-[2px]",children:n})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-x-3 gap-y-4",children:p==null?void 0:p.map((o,j)=>e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(R,{to:`/${o.gid}`,children:e.jsx("div",{className:"relative h-[180px]",children:e.jsx("img",{className:`object-cover w-full h-full
                                                    text-sm`,src:v+(o==null?void 0:o.image_url),alt:o.title})})})}),e.jsx("div",{className:`mt-1 text-[15px] tracking-tight 
                                     truncate`,children:o.title}),e.jsx("div",{className:"mt-1",children:e.jsx(Se,{rating:o.avg_rating})}),e.jsx("div",{className:`text-[11px] mt-[5px] tracking-tight
                                    leading-[1.2em]`,children:o.short_description.substring(0,100)})]},j))})]})})},at=()=>{const t=le(),s=t.listing,a=t.gallery,l=t.ratingsData;return e.jsx(De,{children:e.jsxs(ke,{children:[e.jsx(Re,{}),s.gid!==null&&s.gid!==void 0&&e.jsx($e,{listing:s,images:a,ratingsData:l}),e.jsx(We,{category:s==null?void 0:s.category,limit:6,title:`Related: ${s==null?void 0:s.category}`,subtitle:"Related based on the same category."}),e.jsx(_e,{})]})})};export{at as default};
