import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as s}from"./components-DN9bEK-g.js";import{A as E,C as N,a as C}from"./ContentLayout-DWJhEWCO.js";import{u as P}from"./AuthContext-CubD42X1.js";import{t as b,I as R,n as A}from"./lib-Drj-iocb.js";import{z as S,u as I,s as L}from"./index-CORT_df8.js";import{I as T,B as D}from"./Input-SgpnO-Zw.js";import{f as F,e as U}from"./WhiteLogo-BVe8Lk7p.js";import{u as V}from"./NotificationContext-C_vKrWZf.js";import"./UserMenu-D6hgrp3z.js";import"./index-DVg718Gq.js";import"./index-1ASR4AA0.js";import"./HomeNav-Dydl5COM.js";import"./SrchNavbar-DrGwNLOa.js";import"./HamburgerSecondary-CRfMWhI_.js";const W=S.object({email:S.string({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"})}),k=({loaderData:i,user:t})=>{var h;const[a,u]=s.useState(null),[o,n]=s.useState(!1),l=V(),r=P();if(!r)return null;const c=p=>{let w=p.target.value,x=p.target.name;u(m=>({...m,[x]:w}))},d=async p=>{var j;n(!0),l.notify("Sending reset password request."),await new Promise(g=>setTimeout(g,1e3));const x={email:(j=r==null?void 0:r.user)==null?void 0:j.email.trim()},m=await r.resetpw(x);JSON.stringify(m).includes("Error")?(n(!1),l.alertCancel("",b(m))):(l.alertCancel("",b(m)),await new Promise(g=>setTimeout(g,1e3)),n(!1))},{register:f,handleSubmit:v,getValues:B,setValue:q,watch:z,setError:H,formState:{errors:y,isSubmitting:J}}=I({defaultValues:i.userProfile,resolver:L(W)});return e.jsx("form",{onSubmit:v(d),children:e.jsx("div",{className:`${F} mt-0  
                        rounded-lg pt-4 max-w-[500px] w-full mx-auto`,children:e.jsxs("div",{className:U,children:[e.jsx("div",{className:" text-xl text-gray-700 font-semibold border-b pb-1",children:"Reset Password"}),e.jsxs("div",{className:" pt-3 pb-4 text-[13px] leading-5",children:[e.jsx("b",{children:(h=i.userProfile)==null?void 0:h.email})," is your current email. It will be used be used for password resets or changes."]}),e.jsx("div",{className:"mt-[20px]"}),e.jsx(T,{controlTitle:"Your Email Address",controlPlaceholder:"Retype new password",controlName:"email",controlType:"text",disabled:!0,register:f,changeHandler:c,error:y.email}),e.jsx(D,{working:o,value:"Send Reset Email"})]})})})},oe=()=>{s.useEffect(()=>{R(localStorage)},[]);const i=P();if(!i)return null;const{user:t}=i,[a,u]=s.useState(null),[o,n]=s.useState(null),[l,r]=s.useState(!0);return s.useEffect(()=>{async function c(d){const f=await A(d||"");u(f)}t!=null&&t.guid&&c(t==null?void 0:t.guid)},[t==null?void 0:t.guid]),s.useEffect(()=>{a&&n({userProfile:a})},[a]),s.useEffect(()=>{o&&r(!1)},[o]),l?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(E,{children:e.jsxs(N,{title:"Reset Password",children:[a===null?"Loading...":"",e.jsx(C,{baseUrl:"/web/account/profile",guid:"",children:a==null?void 0:a.email}),o&&e.jsx(k,{loaderData:o,user:t})]})})};export{oe as default};
