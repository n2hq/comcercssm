import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as t}from"./components-CooaLra5.js";import{u as B}from"./NotificationContext-G0hiVdBK.js";import{p as z,l as W}from"./lib--grMNbPz.js";const T=t.createContext(null);function X(){return t.useContext(T)}function Y({children:m}){const[C,a]=t.useState(!1),[g,p]=t.useState(!1),[h,c]=t.useState(null),[f,k]=t.useState(null),[x,D]=t.useState(null),[w,j]=t.useState(!1),[b,y]=t.useState(null),r=B(),S=()=>{p(!1),c(null)},_=async()=>{a(!0);let N=document.getElementById("image_title");if(w){const d=new FormData;d.append("file",b),d.append("guid",f),d.append("bid",x),d.append("image_title",N.value),r.notify(),await new Promise(o=>setTimeout(o,2e3));const I="https://tpics.gasimg.com"+"/business_gallery_pic_upload";try{const o=await fetch(I,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*"},body:d});if(o.ok)r.alertReload("","Image uploaded successfully!");else{let U=o.json().then(E=>{r.alert("",E.message)})}}catch{return}finally{a(!1)}}else alert("Please select an image to continue."),a(!1)};let P={dialog:g,setDialog:p,imgSrc:h,setImgSrc:c,handleCloseDialog:S,userGuid:f,setUserGuid:k,businessGuid:x,setBusinessGuid:D,isImgSelected:w,setIsImageSelected:j,selectedFile:b,setSelectedFile:y};return e.jsxs(T.Provider,{value:P,children:[g&&e.jsx("div",{className:`flex w-screen h-screen z-[3000] 
                fixed top-0 left-0 right-0 bottom-0 bg-black/30
                place-content-center place-items-center`,children:e.jsxs("div",{className:`relative w-[90%] h-[80%] bg-white 
                        rounded-[8px] overflow-x-hidden z-[3000]`,onClick:N=>{N.preventDefault()},children:[e.jsx("div",{className:"relative w-full h-[75%] bg-black",children:e.jsx("img",{src:h,alt:"",className:"object-scale-down w-full h-full"})}),e.jsx("div",{children:e.jsx("textarea",{id:"image_title",placeholder:"Enter picture description.",className:"w-full bg-gray-100 px-3  h-[60px] py-3"})}),e.jsxs("div",{className:"flex place-content-end px-3 gap-2",children:[e.jsx("button",{onMouseDown:()=>S(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:"Cancel"}),e.jsx("button",{onClick:()=>_(),className:`bg-blue-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:C?"Working...":"Submit"})]})]})}),m]})}const F=t.createContext(null);function Z(){return t.useContext(F)}function $({children:m}){const[C,a]=t.useState(!1),[g,p]=t.useState(!1),[h,c]=t.useState(null),[f,k]=t.useState(null),[x,D]=t.useState(null),[w,j]=t.useState(!1),[b,y]=t.useState(null),[r,S]=t.useState(null),[_,P]=t.useState(null),[N,d]=t.useState(null),A=t.useRef(null),u=B(),I=()=>{p(!1),c(null),a(!1)},o=()=>{var l;(l=A.current)==null||l.click()},U=l=>{var v;const s=(v=l.target.files)==null?void 0:v[0];if(s){const G=URL.createObjectURL(s);c(G),y(s),j(!0)}},E=async()=>{u.notify(),a(!0),await new Promise(i=>setTimeout(i,1e3));let l=document.getElementById("image_title");const s=new FormData;w&&s.append("file",b),s.append("guid",f),s.append("bid",x),s.append("image_title",l.value),s.append("image_guid",_);const R="https://tpics.gasimg.com"+"/business_gallery_pic_update";try{const i=await fetch(R,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*"},body:s});if(i.ok)u.alert("Image Update","Image updated successfully!");else{let M=i.json().then(n=>{u.alert("",n.message)})}}catch{return}finally{a(!1)}};let L={dialog:g,setDialog:p,handleCloseDialog:I,imgSrc:h,setImgSrc:c,userGuid:f,setUserGuid:k,businessGuid:x,setBusinessGuid:D,isImgSelected:w,setIsImageSelected:j,selectedFile:b,setSelectedFile:y,imageTitle:r,setImageTitle:S,imageGuid:_,setImageGuid:P,deletePhoto:async(l,s,v)=>{const i="https://tpics.gasimg.com"+"/delete_business_gallery_pic",M={guid:l,bid:s,image_guid:v};a(!0),await new Promise(n=>setTimeout(n,1e3));try{const n=await fetch(i,{method:"POST",headers:W,body:JSON.stringify(M)});if(n.ok)u.alertReload("","Image deleted successfully!");else{let J=n.json().then(O=>{u.alert(O.message)})}}catch(n){return alert(n.message)}finally{a(!1)}}};return e.jsxs(F.Provider,{value:L,children:[g&&e.jsx("div",{className:"fixed w-screen h-screen bg-black/30 z-[3000]",children:e.jsx("div",{className:`fixed w-screen h-screen z-[3000] 
                 top-0 left-0 right-0 bottom-0 bg-black/30
                place-content-center place-items-center`,children:e.jsx("div",{className:`relative max-w-[90%] w-[90%] h-[80%] bg-white 
                        rounded-[8px] overflow-hidden z-[3100] mx-auto `,children:e.jsxs("div",{className:"w-full h-full overflow-y-auto",children:[e.jsxs("div",{className:"relative w-full h-[75%] bg-black",children:[e.jsx("img",{src:h,alt:"",className:"object-scale-down w-full h-full"}),e.jsx("input",{type:"file",accept:"image/*",ref:A,className:"hidden",onChange:U}),e.jsx("div",{className:`flex place-content-center place-items-center
                                        bg-black/10 w-full h-full absolute z-0 top-0 object-cover
                                        text-white/80 `,onMouseDown:o,children:e.jsx("div",{className:`w-[60px] h-[60px] flex flex-col
                                        place-content-center place-items-center bg-white/50
                                        hover:cursor-pointer hover:bg-white/50
                                        rounded-full transition duration-300 ease-in-out`,children:e.jsx(z,{className:" text-[30px]"})})})]}),e.jsxs("div",{className:"h-[25%]",children:[e.jsx("textarea",{onChange:l=>S(l.target.value),id:"image_title",value:r,placeholder:"Enter picture description.",className:"w-full bg-gray-100 px-3  h-[60px] py-3"}),e.jsxs("div",{className:"flex place-content-end px-3 gap-2",children:[e.jsx("button",{onMouseDown:()=>I(),className:`bg-gray-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:"Cancel"}),e.jsx("button",{onClick:()=>E(),className:`bg-blue-800 text-white px-3 py-1.5 rounded-md
                                    shadow-md mb-2 mt-4`,children:C?"Working...":"Submit"})]})]})]})})})}),m]})}export{Y as A,$ as E,Z as a,X as u};
