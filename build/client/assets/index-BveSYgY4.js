import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as i,b as N}from"./components-DN9bEK-g.js";import{h as E,I as k,j as A,k as B,e as P}from"./lib-Drj-iocb.js";import{A as C,C as L}from"./ContentLayout-DvnKqlSr.js";import{B as M}from"./BusinessMenu-BlqJeUcB.js";import{u as D}from"./NotificationContext-C_vKrWZf.js";import"./UserMenu-DPyCIWDM.js";import"./index-DVg718Gq.js";import"./index-BPIHIPVt.js";import"./AuthContext-CubD42X1.js";import"./WhiteLogo-BVe8Lk7p.js";import"./HomeNav-Dydl5COM.js";import"./SrchNavbar-Ci9DV9df.js";import"./HamburgerSecondary-CRfMWhI_.js";const F=({businessGuid:r,userGuid:j,allSocialMedia:o,allSelectedSocialMedia:m})=>{const[p,x]=i.useState(!1),c=D(),[f,S]=i.useState(null),[h,v]=i.useState(null),[l,d]=i.useState(null);i.useEffect(()=>{o&&m&&(S(o),v(m))},[o,m]),i.useEffect(()=>{if(f&&h){const s=f.map(a=>{const t=h.find(n=>n.media_id===a.media_id);return{...a,active:!!t,user_description:t?t.user_description:void 0}});d(s)}},[f,h]);const g=s=>{d(a=>a.map(t=>t.media_id===s?{...t,active:!t.active,user_description:t.user_description?t.user_description:""}:t))},u=(s,a)=>{d(t=>t.map(n=>n.media_id===s?{...n,user_description:a}:n))},b=async()=>{const t="https://edition.garssete.com"+"/api/listing/selected_social_media";x(!0),c.notify(),await new Promise(n=>setTimeout(n,1e3));try{const n=l.filter(_=>_.active).map(_=>({media_id:_.media_id,user_description:_.user_description}));(await fetch(t,{method:"POST",headers:E,body:JSON.stringify({user_guid:j,business_guid:r,selected:n})})).ok?c.alertReload("","Saved successfully!"):c.alert("","Failed to save.")}catch{c.alert("","Something happened!")}finally{x(!1)}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Select Social Media"}),o.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l==null?void 0:l.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 p-3 border rounded cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("input",{onChange:()=>g(s.media_id),type:"checkbox",checked:s.active,className:"hidden"}),e.jsx("div",{className:`w-5 h-5 border-[1px] border-black  rounded-none 
                                            ${s.active?"bg-blue-400":"bg-white"}`})]}),e.jsxs("div",{className:" w-full",children:[e.jsx("p",{className:"font-medium ",children:s.name}),e.jsx("div",{className:" w-full h-[50px] mt-1 rounded overflow-hidden",children:e.jsx("textarea",{onChange:a=>u(s.media_id,a.target.value),className:`w-full h-full bg-gray-100
                                            border p-3 text-sm`,children:s.user_description})})]})]},s.media_id))}),e.jsx("button",{onClick:b,className:"mt-5 px-4 py-2 bg-blue-600 text-white rounded",children:"Save Selected Social Media"})]})]})},V=()=>{i.useEffect(()=>{k(localStorage)},[]);const[r,j]=i.useState(""),[o,m]=i.useState(""),[p,x]=i.useState(null),[c,f]=i.useState(null),[S,h]=i.useState(null),[v,l]=i.useState(!0),{business_guid:d,user_guid:g}=N(),[u,b]=i.useState(null);return i.useEffect(()=>{d&&g&&(async(a,t)=>{j(a),m(t);const n=await A();x(n);const y=await B(t,a);f(y);const w=await P(a||"");b(w)})(d,g)},[d,g]),i.useEffect(()=>{r&&o&&p&&c&&u&&(h({businessGuid:r,userGuid:o,facilityFeatures:p,selectedFacilityFeatures:c,businessProfile:u}),l(!1))},[r,o,p,c,u]),v?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading..."})}):e.jsx(C,{children:e.jsxs(L,{title:"Social Media",businessGuid:r,data:S,businessProfile:u,children:[r&&o&&e.jsx(M,{guid:r,userGuid:o}),S&&e.jsx(F,{userGuid:o,businessGuid:r,allSocialMedia:p,allSelectedSocialMedia:c})]})})};export{V as default};
