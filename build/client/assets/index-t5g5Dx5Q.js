import{r as a,j as t}from"./components-BAvBE3fA.js";import{A as N,C as A}from"./ContentLayout-BULv8Qdt.js";import{h as U,c as C,u as L,g as D}from"./AuthContext-Tj_b5086.js";import{z as y,u as R,s as T}from"./index-CC8pXzgA.js";import{f as k,d as B,I as F,B as I}from"./Input-Dw9jNG5H.js";import{u as V}from"./NotificationContext-C8wtauTv.js";import"./MobileNav-C2nYESeh.js";import"./index-E-6-scJO.js";import"./UserMenu-CzhSTjVp.js";const W=y.object({email:y.string({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"})}),_=({loaderData:e,user:s})=>{var x,h,j;const[p,i]=a.useState(null),[u,c]=a.useState(!1),r=V(),m=o=>{let n=o.target.value,P=o.target.name;i(v=>({...v,[P]:n}))},d=async o=>{var b;c(!0);let n="";e.userProfile.active?n="Deactivating...":n="Activating...",r.notify(n),await new Promise(l=>setTimeout(l,1e3));const v="/api/user/activate_deactivate/"+e.userProfile.user_guid,S=C.BASE_URL+v;o.active=!((b=e.userProfile)!=null&&b.active);try{const l=await fetch(S,{method:"PUT",headers:U,body:JSON.stringify(o)});if(l.ok)r.alertReload("Success!",`You are now ${o.active?"activated":"deactivated"}`);else{let O=l.json().then(E=>{r.alertCancel("Error!",E.message)})}}catch(l){r.alertCancel("Error!",l.message)}finally{c(!1)}},{register:f,handleSubmit:w,getValues:$,setValue:Y,watch:z,setError:H,formState:{errors:g,isSubmitting:J}}=R({defaultValues:e.userProfile,resolver:T(W)});return t.jsx("form",{onSubmit:w(d),children:t.jsx("div",{className:`${k} mt-0  
                        rounded-lg pt-4 max-w-[500px] w-full mx-auto`,children:t.jsxs("div",{className:B,children:[t.jsx("div",{className:" text-xl text-gray-700 font-semibold border-b pb-1",children:(x=e.userProfile)!=null&&x.active?"Deactivate User":"Activate User"}),t.jsxs("div",{className:" pt-3 pb-4 text-[13px] leading-5",children:[t.jsx("b",{children:(h=e.userProfile)==null?void 0:h.email})," is your current email. It will be used for password resets or changes."]}),t.jsx("div",{className:"mt-[10px]"}),t.jsx(F,{controlTitle:"Your Email Address",controlPlaceholder:"Retype new password",controlName:"email",controlType:"text",disabled:!0,register:f,changeHandler:m,error:g==null?void 0:g.email}),t.jsx(I,{working:u,value:`${(j=e.userProfile)!=null&&j.active?"Deactivate":"Activate"} Profile`})]})})})},se=()=>{const{user:e}=L(),[s,p]=a.useState(null),[i,u]=a.useState(null),[c,r]=a.useState(!0);return a.useEffect(()=>{async function m(d){const f=await D(d||"");p(f)}e!=null&&e.guid&&m(e==null?void 0:e.guid)},[e==null?void 0:e.guid]),a.useEffect(()=>{s&&u({userProfile:s})},[s]),a.useEffect(()=>{i&&r(!1)},[i]),c?t.jsx("div",{className:"flex justify-center items-center h-screen",children:t.jsx("div",{className:"text-lg",children:"Loading..."})}):t.jsx(N,{children:t.jsxs(A,{title:s.active?"Deactivate Profile":"Activate Profile",children:[s===null?"Loading...":"",t.jsx("div",{className:"font-semibold mb-2 text-md",children:s==null?void 0:s.email}),i&&t.jsx(_,{loaderData:i,user:e})]})})};export{se as default};
