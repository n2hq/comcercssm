import{j as t}from"./jsx-runtime-0DLF9kdB.js";import{r as a}from"./components-DN9bEK-g.js";import{A as N,C as A}from"./ContentLayout-Fl7oK8sA.js";import{u as U}from"./AuthContext-Bd05mLB0.js";import{h as C,f as L,l as D}from"./lib-DkU1NRFm.js";import{z as y,u as R,s as T}from"./index-CORT_df8.js";import{I as k,B}from"./Input-CNUxmG3v.js";import{f as F,e as I}from"./WhiteLogo-D0_DZqmS.js";import{u as V}from"./NotificationContext-DQtpxZot.js";import"./MobileNav-D7FcM9wJ.js";import"./index-BuMB8ucW.js";import"./HomeNav-sGChEP8Q.js";const W=y.object({email:y.string({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"})}),_=({loaderData:e,user:s})=>{var x,h,j;const[v,i]=a.useState(null),[u,c]=a.useState(!1),r=V(),m=o=>{let n=o.target.value,P=o.target.name;i(p=>({...p,[P]:n}))},f=async o=>{var b;c(!0);let n="";e.userProfile.active?n="Deactivating...":n="Activating...",r.notify(n),await new Promise(l=>setTimeout(l,1e3));const p="/api/user/activate_deactivate/"+e.userProfile.user_guid,S=L.BASE_URL+p;o.active=!((b=e.userProfile)!=null&&b.active);try{const l=await fetch(S,{method:"PUT",headers:C,body:JSON.stringify(o)});if(l.ok)r.alertReload("Success!",`You are now ${o.active?"activated":"deactivated"}`);else{let O=l.json().then(E=>{r.alertCancel("Error!",E.message)})}}catch(l){r.alertCancel("Error!",l.message)}finally{c(!1)}},{register:d,handleSubmit:w,getValues:$,setValue:Y,watch:z,setError:H,formState:{errors:g,isSubmitting:J}}=R({defaultValues:e.userProfile,resolver:T(W)});return t.jsx("form",{onSubmit:w(f),children:t.jsx("div",{className:`${F} mt-0  
                        rounded-lg pt-4 max-w-[500px] w-full mx-auto`,children:t.jsxs("div",{className:I,children:[t.jsx("div",{className:" text-xl text-gray-700 font-semibold border-b pb-1",children:(x=e.userProfile)!=null&&x.active?"Deactivate User":"Activate User"}),t.jsxs("div",{className:" pt-3 pb-4 text-[13px] leading-5",children:[t.jsx("b",{children:(h=e.userProfile)==null?void 0:h.email})," is your current email. It will be used for password resets or changes."]}),t.jsx("div",{className:"mt-[10px]"}),t.jsx(k,{controlTitle:"Your Email Address",controlPlaceholder:"Retype new password",controlName:"email",controlType:"text",disabled:!0,register:d,changeHandler:m,error:g==null?void 0:g.email}),t.jsx(B,{working:u,value:`${(j=e.userProfile)!=null&&j.active?"Deactivate":"Activate"} Profile`})]})})})},re=()=>{const{user:e}=U(),[s,v]=a.useState(null),[i,u]=a.useState(null),[c,r]=a.useState(!0);return a.useEffect(()=>{async function m(f){const d=await D(f||"");v(d)}e!=null&&e.guid&&m(e==null?void 0:e.guid)},[e==null?void 0:e.guid]),a.useEffect(()=>{s&&u({userProfile:s})},[s]),a.useEffect(()=>{i&&r(!1)},[i]),c?t.jsx("div",{className:"flex justify-center items-center h-screen",children:t.jsx("div",{className:"text-lg",children:"Loading..."})}):t.jsx(N,{children:t.jsxs(A,{title:s.active?"Deactivate Profile":"Activate Profile",children:[s===null?"Loading...":"",t.jsx("div",{className:"font-semibold mb-2 text-md",children:s==null?void 0:s.email}),i&&t.jsx(_,{loaderData:i,user:e})]})})};export{re as default};
